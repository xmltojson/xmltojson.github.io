<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Flashcard App</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #475569;
            --card-front: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-back: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --radius: 16px;
            --radius-sm: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Background Animation */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .bg-animation span {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--primary);
            opacity: 0.1;
            border-radius: 50%;
            animation: float 15s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.1; }
            90% { opacity: 0.1; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }

        /* App Container */
        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--card-front);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .lang-toggle {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        .lang-btn {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.875rem;
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 1.5rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .nav-tab:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* Views */
        .view {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stats Overview */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .stat-icon.blue { background: rgba(99, 102, 241, 0.2); }
        .stat-icon.green { background: rgba(16, 185, 129, 0.2); }
        .stat-icon.orange { background: rgba(245, 158, 11, 0.2); }
        .stat-icon.red { background: rgba(239, 68, 68, 0.2); }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Deck Grid */
        .deck-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .deck-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .deck-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--card-front);
        }

        .deck-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
            border-color: var(--primary);
        }

        .deck-card.add-new {
            border: 2px dashed var(--border);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            background: transparent;
        }

        .deck-card.add-new::before {
            display: none;
        }

        .deck-card.add-new:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .add-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 1rem;
            transition: all 0.3s;
        }

        .deck-card.add-new:hover .add-icon {
            background: var(--primary);
            transform: scale(1.1);
        }

        .deck-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .deck-emoji {
            font-size: 2.5rem;
        }

        .deck-actions {
            display: flex;
            gap: 0.5rem;
        }

        .deck-action-btn {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .deck-action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .deck-action-btn.delete:hover {
            background: var(--danger);
        }

        .deck-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .deck-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .deck-stats {
            display: flex;
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .deck-stat {
            text-align: center;
            flex: 1;
        }

        .deck-stat-value {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .deck-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .deck-progress {
            margin-top: 1rem;
        }

        .progress-bar {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            text-align: right;
        }

        /* Study View */
        .study-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .study-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .study-info h2 {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .study-info p {
            color: var(--text-secondary);
        }

        .study-progress-bar {
            flex: 1;
            max-width: 300px;
            min-width: 200px;
        }

        .study-progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        /* Flashcard */
        .flashcard-container {
            perspective: 1000px;
            margin-bottom: 2rem;
        }

        .flashcard {
            width: 100%;
            height: 350px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: var(--radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .flashcard-front {
            background: var(--card-front);
        }

        .flashcard-back {
            background: var(--card-back);
            transform: rotateY(180deg);
        }

        .flashcard-content {
            font-size: 1.5rem;
            font-weight: 500;
            line-height: 1.6;
            max-width: 100%;
            word-wrap: break-word;
        }

        .flashcard-hint {
            position: absolute;
            bottom: 1.5rem;
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .flip-indicator {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            opacity: 0.6;
        }

        /* Rating Buttons */
        .rating-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }

        .rating-btn {
            padding: 1rem;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .rating-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .rating-btn.again {
            background: var(--danger);
            color: white;
        }

        .rating-btn.hard {
            background: var(--warning);
            color: white;
        }

        .rating-btn.good {
            background: var(--success);
            color: white;
        }

        .rating-btn.easy {
            background: var(--primary);
            color: white;
        }

        .rating-label {
            display: block;
            font-size: 0.75rem;
            opacity: 0.8;
            margin-top: 0.25rem;
            font-weight: 400;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .empty-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .empty-text {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.25rem;
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .emoji-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .emoji-btn {
            width: 40px;
            height: 40px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--bg-tertiary);
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .emoji-btn:hover,
        .emoji-btn.selected {
            border-color: var(--primary);
            background: var(--primary);
            transform: scale(1.1);
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-sm);
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* Cards List in Modal */
        .cards-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .card-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            margin-bottom: 0.5rem;
        }

        .card-item-content {
            flex: 1;
            min-width: 0;
        }

        .card-item-front {
            font-weight: 500;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-item-back {
            font-size: 0.875rem;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-item-actions {
            display: flex;
            gap: 0.5rem;
            margin-left: 1rem;
        }

        /* Statistics View */
        .stats-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .chart-container {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }

        .chart-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            gap: 0.5rem;
            height: 200px;
            padding-top: 1rem;
        }

        .chart-bar-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
        }

        .chart-bar {
            width: 100%;
            max-width: 40px;
            background: var(--primary);
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
            min-height: 4px;
        }

        .chart-bar-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            text-align: center;
        }

        .chart-bar-value {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }

        /* Streak Display */
        .streak-display {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }

        .streak-icon {
            font-size: 3rem;
        }

        .streak-info h3 {
            font-size: 2rem;
            font-weight: 700;
        }

        .streak-info p {
            color: var(--text-secondary);
        }

        /* Due Cards Badge */
        .due-badge {
            background: var(--danger);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .toast {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: var(--shadow);
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }

        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.info { border-left: 4px solid var(--primary); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }

            .logo-text {
                display: none;
            }

            .main-content {
                padding: 1rem;
            }

            .nav-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
                padding-bottom: 0.5rem;
            }

            .nav-tab {
                white-space: nowrap;
                flex-shrink: 0;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .deck-grid {
                grid-template-columns: 1fr;
            }

            .flashcard {
                height: 280px;
            }

            .flashcard-content {
                font-size: 1.25rem;
            }

            .rating-buttons {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal {
                max-height: 85vh;
            }

            .toast-container {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
            }

            .toast {
                max-width: 100%;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .study-header {
                flex-direction: column;
                align-items: stretch;
            }

            .study-progress-bar {
                max-width: 100%;
            }

            .flashcard {
                height: 250px;
            }

            .flashcard-content {
                font-size: 1.125rem;
            }
        }

        /* Landscape Mode Adjustments */
        @media (max-height: 500px) and (orientation: landscape) {
            .flashcard {
                height: 200px;
            }

            .flashcard-content {
                font-size: 1rem;
            }

            .rating-buttons {
                grid-template-columns: repeat(4, 1fr);
            }

            .rating-btn {
                padding: 0.75rem;
            }

            .rating-label {
                display: none;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Study Complete Animation */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3000;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s ease-out forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-animation" id="bgAnimation"></div>

    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üìö</div>
                <span class="logo-text" data-i18n="appName">–ö–∞—Ä—Ç–∫–∏</span>
            </div>
            <div class="header-actions">
                <div class="lang-toggle">
                    <button class="lang-btn active" data-lang="uk">UA</button>
                    <button class="lang-btn" data-lang="en">EN</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Navigation Tabs -->
            <nav class="nav-tabs">
                <button class="nav-tab active" data-view="decks">
                    <span data-i18n="navDecks">üìÇ –ö–æ–ª–æ–¥–∏</span>
                </button>
                <button class="nav-tab" data-view="study">
                    <span data-i18n="navStudy">üìñ –í–∏–≤—á–µ–Ω–Ω—è</span>
                    <span class="due-badge" id="dueBadge" style="display: none;">0</span>
                </button>
                <button class="nav-tab" data-view="stats">
                    <span data-i18n="navStats">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </button>
            </nav>

            <!-- Decks View -->
            <section class="view active" id="decksView">
                <!-- Stats Overview -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">üìö</div>
                        <div class="stat-value" id="totalDecks">0</div>
                        <div class="stat-label" data-i18n="totalDecks">–í—Å—å–æ–≥–æ –∫–æ–ª–æ–¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">üé¥</div>
                        <div class="stat-value" id="totalCards">0</div>
                        <div class="stat-label" data-i18n="totalCards">–í—Å—å–æ–≥–æ –∫–∞—Ä—Ç–æ–∫</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">‚è∞</div>
                        <div class="stat-value" id="dueCards">0</div>
                        <div class="stat-label" data-i18n="dueCards">–î–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon red">üî•</div>
                        <div class="stat-value" id="currentStreak">0</div>
                        <div class="stat-label" data-i18n="dayStreak">–î–Ω—ñ–≤ –ø–æ—Å–ø—ñ–ª—å</div>
                    </div>
                </div>

                <!-- Deck Grid -->
                <div class="deck-grid" id="deckGrid">
                    <!-- Decks will be rendered here -->
                </div>
            </section>

            <!-- Study View -->
            <section class="view" id="studyView">
                <div class="study-container">
                    <div id="studyContent">
                        <!-- Study content will be rendered here -->
                    </div>
                </div>
            </section>

            <!-- Stats View -->
            <section class="view" id="statsView">
                <div class="stats-container">
                    <div class="streak-display">
                        <div class="streak-icon">üî•</div>
                        <div class="streak-info">
                            <h3 id="streakDays">0 <span data-i18n="days">–¥–Ω—ñ–≤</span></h3>
                            <p data-i18n="streakDesc">–í–∞—à–∞ –ø–æ—Ç–æ—á–Ω–∞ —Å–µ—Ä—ñ—è –≤–∏–≤—á–µ–Ω–Ω—è</p>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3 class="chart-title" data-i18n="weeklyActivity">–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞ —Ç–∏–∂–¥–µ–Ω—å</h3>
                        <div class="chart-bars" id="weeklyChart">
                            <!-- Chart bars will be rendered here -->
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon green">‚úÖ</div>
                            <div class="stat-value" id="totalReviewed">0</div>
                            <div class="stat-label" data-i18n="totalReviewed">–í—Å—å–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–æ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon blue">üìà</div>
                            <div class="stat-value" id="avgAccuracy">0%</div>
                            <div class="stat-label" data-i18n="avgAccuracy">–°–µ—Ä–µ–¥–Ω—è —Ç–æ—á–Ω—ñ—Å—Ç—å</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon orange">‚è±Ô∏è</div>
                            <div class="stat-value" id="studyTime">0</div>
                            <div class="stat-label" data-i18n="studyTime">–•–≤–∏–ª–∏–Ω –≤–∏–≤—á–µ–Ω–Ω—è</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon red">üèÜ</div>
                            <div class="stat-value" id="masteredCards">0</div>
                            <div class="stat-label" data-i18n="masteredCards">–í–∏–≤—á–µ–Ω–æ –∫–∞—Ä—Ç–æ–∫</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Creating/Editing Deck -->
    <div class="modal-overlay" id="deckModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="deckModalTitle" data-i18n="createDeck">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–æ–¥—É</h3>
                <button class="modal-close" onclick="closeModal('deckModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" data-i18n="deckName">–ù–∞–∑–≤–∞ –∫–æ–ª–æ–¥–∏</label>
                    <input type="text" class="form-input" id="deckName" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞">
                </div>
                <div class="form-group">
                    <label class="form-label" data-i18n="deckDescription">–û–ø–∏—Å</label>
                    <textarea class="form-textarea" id="deckDescription" placeholder="–ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å –∫–æ–ª–æ–¥–∏..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" data-i18n="deckEmoji">–Ü–∫–æ–Ω–∫–∞</label>
                    <div class="emoji-picker" id="emojiPicker">
                        <!-- Emojis will be rendered here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('deckModal')" data-i18n="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-primary" id="saveDeckBtn" data-i18n="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- Modal for Adding/Editing Card -->
    <div class="modal-overlay" id="cardModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="cardModalTitle" data-i18n="addCard">–î–æ–¥–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É</h3>
                <button class="modal-close" onclick="closeModal('cardModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" data-i18n="cardFront">–ü–µ—Ä–µ–¥–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ (–ø–∏—Ç–∞–Ω–Ω—è)</label>
                    <textarea class="form-textarea" id="cardFront" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ —Ç–µ—Ä–º—ñ–Ω..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" data-i18n="cardBack">–ó–∞–¥–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ (–≤—ñ–¥–ø–æ–≤—ñ–¥—å)</label>
                    <textarea class="form-textarea" id="cardBack" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∞–±–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('cardModal')" data-i18n="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-primary" id="saveCardBtn" data-i18n="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- Modal for Managing Cards -->
    <div class="modal-overlay" id="manageCardsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" data-i18n="manageCards">–ö–µ—Ä—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∞–º–∏</h3>
                <button class="modal-close" onclick="closeModal('manageCardsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <button class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;" onclick="openAddCardModal()" data-i18n="addNewCard">+ –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –∫–∞—Ä—Ç–∫—É</button>
                <div class="cards-list" id="cardsList">
                    <!-- Cards will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ==================== Translations ====================
        const translations = {
            uk: {
                appName: '–ö–∞—Ä—Ç–∫–∏',
                navDecks: 'üìÇ –ö–æ–ª–æ–¥–∏',
                navStudy: 'üìñ –í–∏–≤—á–µ–Ω–Ω—è',
                navStats: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                totalDecks: '–í—Å—å–æ–≥–æ –∫–æ–ª–æ–¥',
                totalCards: '–í—Å—å–æ–≥–æ –∫–∞—Ä—Ç–æ–∫',
                dueCards: '–î–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è',
                dayStreak: '–î–Ω—ñ–≤ –ø–æ—Å–ø—ñ–ª—å',
                createDeck: '–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–æ–¥—É',
                editDeck: '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–æ–ª–æ–¥—É',
                deckName: '–ù–∞–∑–≤–∞ –∫–æ–ª–æ–¥–∏',
                deckDescription: '–û–ø–∏—Å',
                deckEmoji: '–Ü–∫–æ–Ω–∫–∞',
                cancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
                save: '–ó–±–µ—Ä–µ–≥—Ç–∏',
                addCard: '–î–æ–¥–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É',
                editCard: '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É',
                cardFront: '–ü–µ—Ä–µ–¥–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ (–ø–∏—Ç–∞–Ω–Ω—è)',
                cardBack: '–ó–∞–¥–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ (–≤—ñ–¥–ø–æ–≤—ñ–¥—å)',
                manageCards: '–ö–µ—Ä—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∞–º–∏',
                addNewCard: '+ –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –∫–∞—Ä—Ç–∫—É',
                cards: '–∫–∞—Ä—Ç–æ–∫',
                mastered: '–≤–∏–≤—á–µ–Ω–æ',
                learning: '–≤–∏–≤—á–∞—î—Ç—å—Å—è',
                progress: '–ø—Ä–æ–≥—Ä–µ—Å',
                addFirstDeck: '–°—Ç–≤–æ—Ä—ñ—Ç—å –ø–µ—Ä—à—É –∫–æ–ª–æ–¥—É',
                addFirstDeckDesc: '–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ, —â–æ–± –ø–æ—á–∞—Ç–∏',
                createNewDeck: '–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–æ–¥—É',
                selectDeckToStudy: '–û–±–µ—Ä—ñ—Ç—å –∫–æ–ª–æ–¥—É –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è',
                selectDeckDesc: '–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ —Ä–æ–∑–¥—ñ–ª—É "–ö–æ–ª–æ–¥–∏" —Ç–∞ –æ–±–µ—Ä—ñ—Ç—å –∫–æ–ª–æ–¥—É',
                noCardsToStudy: '–ù–µ–º–∞—î –∫–∞—Ä—Ç–æ–∫ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è',
                noCardsDesc: '–í—Å—ñ –∫–∞—Ä—Ç–∫–∏ –≤–∏–≤—á–µ–Ω–æ! –ü–æ–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –ø—ñ–∑–Ω—ñ—à–µ.',
                allDone: '–ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞! üéâ',
                clickToFlip: '–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å, —â–æ–± –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏',
                showAnswer: '–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å',
                again: '–ó–Ω–æ–≤—É',
                hard: '–í–∞–∂–∫–æ',
                good: '–î–æ–±—Ä–µ',
                easy: '–õ–µ–≥–∫–æ',
                min1: '<1 —Ö–≤',
                min10: '<10 —Ö–≤',
                day1: '1 –¥–µ–Ω—å',
                days4: '4 –¥–Ω—ñ',
                cardOf: '–ö–∞—Ä—Ç–∫–∞',
                of: '–∑',
                weeklyActivity: '–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞ —Ç–∏–∂–¥–µ–Ω—å',
                days: '–¥–Ω—ñ–≤',
                streakDesc: '–í–∞—à–∞ –ø–æ—Ç–æ—á–Ω–∞ —Å–µ—Ä—ñ—è –≤–∏–≤—á–µ–Ω–Ω—è',
                totalReviewed: '–í—Å—å–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–æ',
                avgAccuracy: '–°–µ—Ä–µ–¥–Ω—è —Ç–æ—á–Ω—ñ—Å—Ç—å',
                studyTime: '–•–≤–∏–ª–∏–Ω –≤–∏–≤—á–µ–Ω–Ω—è',
                masteredCards: '–í–∏–≤—á–µ–Ω–æ –∫–∞—Ä—Ç–æ–∫',
                deckCreated: '–ö–æ–ª–æ–¥—É —Å—Ç–≤–æ—Ä–µ–Ω–æ!',
                deckUpdated: '–ö–æ–ª–æ–¥—É –æ–Ω–æ–≤–ª–µ–Ω–æ!',
                deckDeleted: '–ö–æ–ª–æ–¥—É –≤–∏–¥–∞–ª–µ–Ω–æ!',
                cardAdded: '–ö–∞—Ä—Ç–∫—É –¥–æ–¥–∞–Ω–æ!',
                cardUpdated: '–ö–∞—Ä—Ç–∫—É –æ–Ω–æ–≤–ª–µ–Ω–æ!',
                cardDeleted: '–ö–∞—Ä—Ç–∫—É –≤–∏–¥–∞–ª–µ–Ω–æ!',
                confirmDeleteDeck: '–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –∫–æ–ª–æ–¥—É?',
                confirmDeleteCard: '–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –∫–∞—Ä—Ç–∫—É?',
                mon: '–ü–Ω',
                tue: '–í—Ç',
                wed: '–°—Ä',
                thu: '–ß—Ç',
                fri: '–ü—Ç',
                sat: '–°–±',
                sun: '–ù–¥',
                studyComplete: '–°–µ—Å—ñ—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ!',
                cardsReviewed: '–∫–∞—Ä—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–µ–Ω–æ'
            },
            en: {
                appName: 'Flashcards',
                navDecks: 'üìÇ Decks',
                navStudy: 'üìñ Study',
                navStats: 'üìä Statistics',
                totalDecks: 'Total Decks',
                totalCards: 'Total Cards',
                dueCards: 'Due for Review',
                dayStreak: 'Day Streak',
                createDeck: 'Create Deck',
                editDeck: 'Edit Deck',
                deckName: 'Deck Name',
                deckDescription: 'Description',
                deckEmoji: 'Icon',
                cancel: 'Cancel',
                save: 'Save',
                addCard: 'Add Card',
                editCard: 'Edit Card',
                cardFront: 'Front Side (Question)',
                cardBack: 'Back Side (Answer)',
                manageCards: 'Manage Cards',
                addNewCard: '+ Add New Card',
                cards: 'cards',
                mastered: 'mastered',
                learning: 'learning',
                progress: 'progress',
                addFirstDeck: 'Create Your First Deck',
                addFirstDeckDesc: 'Click the button below to get started',
                createNewDeck: 'Create Deck',
                selectDeckToStudy: 'Select a Deck to Study',
                selectDeckDesc: 'Go to "Decks" section and select a deck',
                noCardsToStudy: 'No Cards to Study',
                noCardsDesc: 'All cards reviewed! Come back later.',
                allDone: 'Great Job! üéâ',
                clickToFlip: 'Click to flip',
                showAnswer: 'Show Answer',
                again: 'Again',
                hard: 'Hard',
                good: 'Good',
                easy: 'Easy',
                min1: '<1 min',
                min10: '<10 min',
                day1: '1 day',
                days4: '4 days',
                cardOf: 'Card',
                of: 'of',
                weeklyActivity: 'Weekly Activity',
                days: 'days',
                streakDesc: 'Your current study streak',
                totalReviewed: 'Total Reviewed',
                avgAccuracy: 'Average Accuracy',
                studyTime: 'Minutes Studied',
                masteredCards: 'Cards Mastered',
                deckCreated: 'Deck created!',
                deckUpdated: 'Deck updated!',
                deckDeleted: 'Deck deleted!',
                cardAdded: 'Card added!',
                cardUpdated: 'Card updated!',
                cardDeleted: 'Card deleted!',
                confirmDeleteDeck: 'Delete this deck?',
                confirmDeleteCard: 'Delete this card?',
                mon: 'Mon',
                tue: 'Tue',
                wed: 'Wed',
                thu: 'Thu',
                fri: 'Fri',
                sat: 'Sat',
                sun: 'Sun',
                studyComplete: 'Session Complete!',
                cardsReviewed: 'cards reviewed'
            }
        };

        // ==================== App State ====================
        let state = {
            language: 'uk',
            decks: [],
            currentDeckId: null,
            currentCardIndex: 0,
            studyQueue: [],
            stats: {
                streak: 0,
                lastStudyDate: null,
                totalReviewed: 0,
                correctAnswers: 0,
                studyTimeMinutes: 0,
                weeklyActivity: [0, 0, 0, 0, 0, 0, 0]
            },
            editingDeckId: null,
            editingCardId: null,
            selectedEmoji: 'üìö',
            studyStartTime: null
        };

        const emojis = ['üìö', 'üåç', 'üî¨', 'üé®', 'üéµ', 'üíª', 'üèãÔ∏è', 'üç≥', '‚úàÔ∏è', 'üéÆ', 'üìê', 'üß™', 'üìñ', 'üéØ', 'üí°', 'üåü'];

        // ==================== Utility Functions ====================
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function t(key) {
            return translations[state.language][key] || key;
        }

        function saveState() {
            localStorage.setItem('flashcardAppState', JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem('flashcardAppState');
            if (saved) {
                const parsed = JSON.parse(saved);
                state = { ...state, ...parsed };
            }
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span>${type === 'success' ? '‚úì' : type === 'error' ? '‚úï' : '‚Ñπ'}</span>
                <span>${message}</span>
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // ==================== Spaced Repetition Algorithm ====================
        function calculateNextReview(card, rating) {
            // SM-2 inspired algorithm
            const now = Date.now();
            let { interval = 1, easeFactor = 2.5, repetitions = 0 } = card;

            if (rating === 0) { // Again
                repetitions = 0;
                interval = 1;
            } else if (rating === 1) { // Hard
                interval = Math.max(1, interval * 1.2);
            } else if (rating === 2) { // Good
                if (repetitions === 0) interval = 1;
                else if (repetitions === 1) interval = 6;
                else interval = Math.round(interval * easeFactor);
                repetitions++;
                easeFactor = Math.max(1.3, easeFactor + 0.1);
            } else if (rating === 3) { // Easy
                if (repetitions === 0) interval = 4;
                else interval = Math.round(interval * easeFactor * 1.3);
                repetitions++;
                easeFactor = Math.max(1.3, easeFactor + 0.15);
            }

            return {
                ...card,
                interval,
                easeFactor,
                repetitions,
                lastReview: now,
                nextReview: now + interval * 24 * 60 * 60 * 1000,
                mastered: repetitions >= 5
            };
        }

        function isDue(card) {
            if (!card.nextReview) return true;
            return Date.now() >= card.nextReview;
        }

        function getDueCards(deck) {
            return deck.cards.filter(card => isDue(card));
        }

        function getAllDueCards() {
            let due = 0;
            state.decks.forEach(deck => {
                due += getDueCards(deck).length;
            });
            return due;
        }

        // ==================== UI Update Functions ====================
        function updateLanguage() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[state.language][key]) {
                    el.textContent = translations[state.language][key];
                }
            });
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === state.language);
            });

            // Update placeholders
            const deckNameInput = document.getElementById('deckName');
            const deckDescInput = document.getElementById('deckDescription');
            const cardFrontInput = document.getElementById('cardFront');
            const cardBackInput = document.getElementById('cardBack');

            if (state.language === 'uk') {
                deckNameInput.placeholder = '–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞';
                deckDescInput.placeholder = '–ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å –∫–æ–ª–æ–¥–∏...';
                cardFrontInput.placeholder = '–í–≤–µ–¥—ñ—Ç—å –ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ —Ç–µ—Ä–º—ñ–Ω...';
                cardBackInput.placeholder = '–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∞–±–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è...';
            } else {
                deckNameInput.placeholder = 'e.g., English Vocabulary';
                deckDescInput.placeholder = 'Brief description of the deck...';
                cardFrontInput.placeholder = 'Enter question or term...';
                cardBackInput.placeholder = 'Enter answer or definition...';
            }
        }

        function updateStats() {
            document.getElementById('totalDecks').textContent = state.decks.length;
            document.getElementById('totalCards').textContent = state.decks.reduce((sum, d) => sum + d.cards.length, 0);
            document.getElementById('dueCards').textContent = getAllDueCards();
            document.getElementById('currentStreak').textContent = state.stats.streak;

            // Update due badge
            const dueCount = getAllDueCards();
            const badge = document.getElementById('dueBadge');
            if (dueCount > 0) {
                badge.style.display = 'inline';
                badge.textContent = dueCount;
            } else {
                badge.style.display = 'none';
            }

            // Update stats view
            document.getElementById('streakDays').innerHTML = `${state.stats.streak} <span data-i18n="days">${t('days')}</span>`;
            document.getElementById('totalReviewed').textContent = state.stats.totalReviewed;
            const accuracy = state.stats.totalReviewed > 0 
                ? Math.round((state.stats.correctAnswers / state.stats.totalReviewed) * 100) 
                : 0;
            document.getElementById('avgAccuracy').textContent = accuracy + '%';
            document.getElementById('studyTime').textContent = state.stats.studyTimeMinutes;
            
            const mastered = state.decks.reduce((sum, d) => 
                sum + d.cards.filter(c => c.mastered).length, 0);
            document.getElementById('masteredCards').textContent = mastered;

            updateWeeklyChart();
        }

        function updateWeeklyChart() {
            const chart = document.getElementById('weeklyChart');
            const days = [t('mon'), t('tue'), t('wed'), t('thu'), t('fri'), t('sat'), t('sun')];
            const maxValue = Math.max(...state.stats.weeklyActivity, 1);

            chart.innerHTML = state.stats.weeklyActivity.map((value, i) => `
                <div class="chart-bar-container">
                    <div class="chart-bar-value">${value}</div>
                    <div class="chart-bar" style="height: ${(value / maxValue) * 150}px"></div>
                    <div class="chart-bar-label">${days[i]}</div>
                </div>
            `).join('');
        }

        function renderDecks() {
            const grid = document.getElementById('deckGrid');
            
            if (state.decks.length === 0) {
                grid.innerHTML = `
                    <div class="deck-card add-new" onclick="openCreateDeckModal()">
                        <div class="add-icon">+</div>
                        <div class="deck-title" data-i18n="addFirstDeck">${t('addFirstDeck')}</div>
                        <p style="color: var(--text-secondary); text-align: center;" data-i18n="addFirstDeckDesc">${t('addFirstDeckDesc')}</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = state.decks.map(deck => {
                const dueCount = getDueCards(deck).length;
                const masteredCount = deck.cards.filter(c => c.mastered).length;
                const progress = deck.cards.length > 0 
                    ? Math.round((masteredCount / deck.cards.length) * 100) 
                    : 0;

                return `
                    <div class="deck-card" onclick="selectDeck('${deck.id}')">
                        <div class="deck-header">
                            <div class="deck-emoji">${deck.emoji}</div>
                            <div class="deck-actions" onclick="event.stopPropagation()">
                                <button class="deck-action-btn" onclick="openManageCardsModal('${deck.id}')" title="Manage Cards">üìù</button>
                                <button class="deck-action-btn" onclick="openEditDeckModal('${deck.id}')" title="Edit">‚úèÔ∏è</button>
                                <button class="deck-action-btn delete" onclick="deleteDeck('${deck.id}')" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        <h3 class="deck-title">${deck.name}</h3>
                        <p class="deck-description">${deck.description || ''}</p>
                        <div class="deck-stats">
                            <div class="deck-stat">
                                <div class="deck-stat-value">${deck.cards.length}</div>
                                <div class="deck-stat-label" data-i18n="cards">${t('cards')}</div>
                            </div>
                            <div class="deck-stat">
                                <div class="deck-stat-value" style="color: var(--warning)">${dueCount}</div>
                                <div class="deck-stat-label" data-i18n="dueCards">${t('dueCards')}</div>
                            </div>
                            <div class="deck-stat">
                                <div class="deck-stat-value" style="color: var(--success)">${masteredCount}</div>
                                <div class="deck-stat-label" data-i18n="mastered">${t('mastered')}</div>
                            </div>
                        </div>
                        <div class="deck-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progress}%"></div>
                            </div>
                            <div class="progress-text">${progress}% ${t('progress')}</div>
                        </div>
                    </div>
                `;
            }).join('') + `
                <div class="deck-card add-new" onclick="openCreateDeckModal()">
                    <div class="add-icon">+</div>
                    <div class="deck-title" data-i18n="createNewDeck">${t('createNewDeck')}</div>
                </div>
            `;
        }

        function renderStudyView() {
            const content = document.getElementById('studyContent');

            if (!state.currentDeckId) {
                content.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìñ</div>
                        <h2 class="empty-title" data-i18n="selectDeckToStudy">${t('selectDeckToStudy')}</h2>
                        <p class="empty-text" data-i18n="selectDeckDesc">${t('selectDeckDesc')}</p>
                    </div>
                `;
                return;
            }

            const deck = state.decks.find(d => d.id === state.currentDeckId);
            if (!deck) return;

            const dueCards = getDueCards(deck);
            
            if (dueCards.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üéâ</div>
                        <h2 class="empty-title" data-i18n="noCardsToStudy">${t('noCardsToStudy')}</h2>
                        <p class="empty-text" data-i18n="noCardsDesc">${t('noCardsDesc')}</p>
                        <button class="btn btn-primary" onclick="switchView('decks')" data-i18n="navDecks">${t('navDecks')}</button>
                    </div>
                `;
                return;
            }

            if (state.studyQueue.length === 0) {
                state.studyQueue = [...dueCards];
                state.currentCardIndex = 0;
                state.studyStartTime = Date.now();
            }

            if (state.currentCardIndex >= state.studyQueue.length) {
                // Session complete
                const studyTime = Math.round((Date.now() - state.studyStartTime) / 60000);
                state.stats.studyTimeMinutes += studyTime;
                
                showConfetti();
                
                content.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üèÜ</div>
                        <h2 class="empty-title" data-i18n="allDone">${t('allDone')}</h2>
                        <p class="empty-text">${state.studyQueue.length} ${t('cardsReviewed')}</p>
                        <button class="btn btn-primary" onclick="resetStudySession()" data-i18n="navDecks">${t('navDecks')}</button>
                    </div>
                `;
                
                state.studyQueue = [];
                state.currentCardIndex = 0;
                updateStreak();
                saveState();
                return;
            }

            const currentCard = state.studyQueue[state.currentCardIndex];
            const progress = Math.round((state.currentCardIndex / state.studyQueue.length) * 100);

            content.innerHTML = `
                <div class="study-header">
                    <div class="study-info">
                        <h2>${deck.emoji} ${deck.name}</h2>
                        <p>${t('cardOf')} ${state.currentCardIndex + 1} ${t('of')} ${state.studyQueue.length}</p>
                    </div>
                    <div class="study-progress-bar">
                        <div class="study-progress-text">
                            <span>${t('progress')}</span>
                            <span>${progress}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                    </div>
                </div>

                <div class="flashcard-container">
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="flashcard-face flashcard-front">
                            <div class="flip-indicator">üîÑ</div>
                            <div class="flashcard-content">${currentCard.front}</div>
                            <div class="flashcard-hint" data-i18n="clickToFlip">${t('clickToFlip')}</div>
                        </div>
                        <div class="flashcard-face flashcard-back">
                            <div class="flip-indicator">üîÑ</div>
                            <div class="flashcard-content">${currentCard.back}</div>
                        </div>
                    </div>
                </div>

                <div class="rating-buttons" id="ratingButtons" style="display: none;">
                    <button class="rating-btn again" onclick="rateCard(0)">
                        ${t('again')}
                        <span class="rating-label">${t('min1')}</span>
                    </button>
                    <button class="rating-btn hard" onclick="rateCard(1)">
                        ${t('hard')}
                        <span class="rating-label">${t('min10')}</span>
                    </button>
                    <button class="rating-btn good" onclick="rateCard(2)">
                        ${t('good')}
                        <span class="rating-label">${t('day1')}</span>
                    </button>
                    <button class="rating-btn easy" onclick="rateCard(3)">
                        ${t('easy')}
                        <span class="rating-label">${t('days4')}</span>
                    </button>
                </div>
            `;
        }

        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            const ratingButtons = document.getElementById('ratingButtons');
            
            if (flashcard) {
                flashcard.classList.toggle('flipped');
                if (flashcard.classList.contains('flipped')) {
                    ratingButtons.style.display = 'grid';
                }
            }
        }

        function rateCard(rating) {
            const deck = state.decks.find(d => d.id === state.currentDeckId);
            if (!deck) return;

            const currentCard = state.studyQueue[state.currentCardIndex];
            const cardIndex = deck.cards.findIndex(c => c.id === currentCard.id);
            
            if (cardIndex !== -1) {
                deck.cards[cardIndex] = calculateNextReview(deck.cards[cardIndex], rating);
                
                // Update stats
                state.stats.totalReviewed++;
                if (rating >= 2) state.stats.correctAnswers++;
                
                // Update weekly activity
                const today = new Date().getDay();
                const dayIndex = today === 0 ? 6 : today - 1;
                state.stats.weeklyActivity[dayIndex]++;
            }

            state.currentCardIndex++;
            saveState();
            renderStudyView();
            updateStats();
        }

        function resetStudySession() {
            state.studyQueue = [];
            state.currentCardIndex = 0;
            state.currentDeckId = null;
            switchView('decks');
        }

        function updateStreak() {
            const today = new Date().toDateString();
            const lastStudy = state.stats.lastStudyDate;

            if (lastStudy) {
                const lastDate = new Date(lastStudy);
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);

                if (lastDate.toDateString() === yesterday.toDateString()) {
                    state.stats.streak++;
                } else if (lastDate.toDateString() !== today) {
                    state.stats.streak = 1;
                }
            } else {
                state.stats.streak = 1;
            }

            state.stats.lastStudyDate = today;
        }

        // ==================== Modal Functions ====================
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function renderEmojiPicker() {
            const picker = document.getElementById('emojiPicker');
            picker.innerHTML = emojis.map(emoji => `
                <button type="button" class="emoji-btn ${emoji === state.selectedEmoji ? 'selected' : ''}" 
                        onclick="selectEmoji('${emoji}')">${emoji}</button>
            `).join('');
        }

        function selectEmoji(emoji) {
            state.selectedEmoji = emoji;
            renderEmojiPicker();
        }

        function openCreateDeckModal() {
            state.editingDeckId = null;
            state.selectedEmoji = 'üìö';
            document.getElementById('deckModalTitle').textContent = t('createDeck');
            document.getElementById('deckName').value = '';
            document.getElementById('deckDescription').value = '';
            renderEmojiPicker();
            openModal('deckModal');
        }

        function openEditDeckModal(deckId) {
            const deck = state.decks.find(d => d.id === deckId);
            if (!deck) return;

            state.editingDeckId = deckId;
            state.selectedEmoji = deck.emoji;
            document.getElementById('deckModalTitle').textContent = t('editDeck');
            document.getElementById('deckName').value = deck.name;
            document.getElementById('deckDescription').value = deck.description || '';
            renderEmojiPicker();
            openModal('deckModal');
        }

        function saveDeck() {
            const name = document.getElementById('deckName').value.trim();
            const description = document.getElementById('deckDescription').value.trim();

            if (!name) {
                showToast('Please enter a deck name', 'error');
                return;
            }

            if (state.editingDeckId) {
                const deck = state.decks.find(d => d.id === state.editingDeckId);
                if (deck) {
                    deck.name = name;
                    deck.description = description;
                    deck.emoji = state.selectedEmoji;
                    showToast(t('deckUpdated'), 'success');
                }
            } else {
                state.decks.push({
                    id: generateId(),
                    name,
                    description,
                    emoji: state.selectedEmoji,
                    cards: [],
                    createdAt: Date.now()
                });
                showToast(t('deckCreated'), 'success');
            }

            saveState();
            renderDecks();
            updateStats();
            closeModal('deckModal');
        }

        function deleteDeck(deckId) {
            if (confirm(t('confirmDeleteDeck'))) {
                state.decks = state.decks.filter(d => d.id !== deckId);
                if (state.currentDeckId === deckId) {
                    state.currentDeckId = null;
                    state.studyQueue = [];
                }
                saveState();
                renderDecks();
                updateStats();
                showToast(t('deckDeleted'), 'success');
            }
        }

        function openManageCardsModal(deckId) {
            state.currentDeckId = deckId;
            renderCardsList();
            openModal('manageCardsModal');
        }

        function renderCardsList() {
            const deck = state.decks.find(d => d.id === state.currentDeckId);
            if (!deck) return;

            const list = document.getElementById('cardsList');
            
            if (deck.cards.length === 0) {
                list.innerHTML = `<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">No cards yet</p>`;
                return;
            }

            list.innerHTML = deck.cards.map(card => `
                <div class="card-item">
                    <div class="card-item-content">
                        <div class="card-item-front">${card.front}</div>
                        <div class="card-item-back">${card.back}</div>
                    </div>
                    <div class="card-item-actions">
                        <button class="deck-action-btn" onclick="openEditCardModal('${card.id}')">‚úèÔ∏è</button>
                        <button class="deck-action-btn delete" onclick="deleteCard('${card.id}')">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function openAddCardModal() {
            state.editingCardId = null;
            document.getElementById('cardModalTitle').textContent = t('addCard');
            document.getElementById('cardFront').value = '';
            document.getElementById('cardBack').value = '';
            openModal('cardModal');
        }

        function openEditCardModal(cardId) {
            const deck = state.decks.find(d => d.id === state.currentDeckId);
            if (!deck) return;

            const card = deck.cards.find(c => c.id === cardId);
            if (!card) return;

            state.editingCardId = cardId;
            document.getElementById('cardModalTitle').textContent = t('editCard');
            document.getElementById('cardFront').value = card.front;
            document.getElementById('cardBack').value = card.back;
            openModal('cardModal');
        }

        function saveCard() {
            const front = document.getElementById('cardFront').value.trim();
            const back = document.getElementById('cardBack').value.trim();

            if (!front || !back) {
                showToast('Please fill in both sides', 'error');
                return;
            }

            const deck = state.decks.find(d => d.id === state.currentDeckId);
            if (!deck) return;

            if (state.editingCardId) {
                const card = deck.cards.find(c => c.id === state.editingCardId);
                if (card) {
                    card.front = front;
                    card.back = back;
                    showToast(t('cardUpdated'), 'success');
                }
            } else {
                deck.cards.push({
                    id: generateId(),
                    front,
                    back,
                    interval: 1,
                    easeFactor: 2.5,
                    repetitions: 0,
                    nextReview: Date.now(),
                    mastered: false
                });
                showToast(t('cardAdded'), 'success');
            }

            saveState();
            renderCardsList();
            renderDecks();
            updateStats();
            closeModal('cardModal');
        }

        function deleteCard(cardId) {
            if (confirm(t('confirmDeleteCard'))) {
                const deck = state.decks.find(d => d.id === state.currentDeckId);
                if (deck) {
                    deck.cards = deck.cards.filter(c => c.id !== cardId);
                    saveState();
                    renderCardsList();
                    renderDecks();
                    updateStats();
                    showToast(t('cardDeleted'), 'success');
                }
            }
        }

        // ==================== Navigation ====================
        function switchView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(viewName + 'View').classList.add('active');
            document.querySelector(`[data-view="${viewName}"]`).classList.add('active');

            if (viewName === 'study') {
                renderStudyView();
            }
        }

        function selectDeck(deckId) {
            state.currentDeckId = deckId;
            state.studyQueue = [];
            state.currentCardIndex = 0;
            saveState();
            switchView('study');
        }

        // ==================== Effects ====================
        function showConfetti() {
            const container = document.createElement('div');
            container.className = 'confetti';
            document.body.appendChild(container);

            const colors = ['#6366f1', '#10b981', '#f59e0b', '#ef4444', '#ec4899'];
            
            for (let i = 0; i < 50; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece';
                piece.style.left = Math.random() * 100 + '%';
                piece.style.background = colors[Math.floor(Math.random() * colors.length)];
                piece.style.animationDelay = Math.random() * 2 + 's';
                piece.style.animationDuration = (2 + Math.random() * 2) + 's';
                container.appendChild(piece);
            }

            setTimeout(() => container.remove(), 5000);
        }

        function createBackgroundAnimation() {
            const container = document.getElementById('bgAnimation');
            for (let i = 0; i < 15; i++) {
                const span = document.createElement('span');
                span.style.left = Math.random() * 100 + '%';
                span.style.animationDelay = Math.random() * 15 + 's';
                span.style.animationDuration = (15 + Math.random() * 10) + 's';
                span.style.width = (10 + Math.random() * 20) + 'px';
                span.style.height = span.style.width;
                container.appendChild(span);
            }
        }

        // ==================== Event Listeners ====================
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                state.language = btn.dataset.lang;
                saveState();
                updateLanguage();
                renderDecks();
                renderStudyView();
                updateStats();
            });
        });

        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                switchView(tab.dataset.view);
            });
        });

        document.getElementById('saveDeckBtn').addEventListener('click', saveDeck);
        document.getElementById('saveCardBtn').addEventListener('click', saveCard);

        // Close modals on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
            }
            
            // Study shortcuts
            if (document.getElementById('studyView').classList.contains('active')) {
                if (e.key === ' ' || e.key === 'Enter') {
                    e.preventDefault();
                    const flashcard = document.getElementById('flashcard');
                    if (flashcard && !flashcard.classList.contains('flipped')) {
                        flipCard();
                    }
                }
                if (e.key >= '1' && e.key <= '4') {
                    const flashcard = document.getElementById('flashcard');
                    if (flashcard && flashcard.classList.contains('flipped')) {
                        rateCard(parseInt(e.key) - 1);
                    }
                }
            }
        });

        // ==================== Initialization ====================
        function init() {
            loadState();
            createBackgroundAnimation();
            updateLanguage();
            renderDecks();
            updateStats();
            renderEmojiPicker();

            // Check and reset weekly activity if new week
            const today = new Date();
            const lastStudy = state.stats.lastStudyDate ? new Date(state.stats.lastStudyDate) : null;
            
            if (lastStudy) {
                const daysDiff = Math.floor((today - lastStudy) / (1000 * 60 * 60 * 24));
                if (daysDiff > 7) {
                    state.stats.weeklyActivity = [0, 0, 0, 0, 0, 0, 0];
                    state.stats.streak = 0;
                    saveState();
                }
            }
        }

        init();
    </script>
</body>
</html>
