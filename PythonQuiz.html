<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Quiz Master</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #306998;
            --secondary: #FFD43B;
            --success: #28a745;
            --danger: #dc3545;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gradient-1: linear-gradient(135deg, #306998 0%, #FFD43B 100%);
            --gradient-2: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .bg-animation .snake {
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            animation: float 15s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.1; }
            90% { opacity: 0.1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo i {
            font-size: 3rem;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #888;
            font-size: 1rem;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--secondary);
        }

        .stat-label {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
        }

        /* Card Styles */
        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
        }

        .welcome-screen h2 {
            color: var(--light);
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .welcome-screen p {
            color: #888;
            margin-bottom: 30px;
        }

        .python-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        /* Category Selection */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }

        .category-card {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .category-card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary);
            background: rgba(255,212,59,0.1);
        }

        .category-card.selected {
            border-color: var(--secondary);
            background: rgba(255,212,59,0.2);
        }

        .category-card i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .category-card h4 {
            color: var(--light);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .category-card .count {
            font-size: 0.7rem;
            color: #888;
            margin-top: 5px;
        }

        .category-card .progress-ring {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 30px;
            height: 30px;
        }

        /* Buttons */
        .btn {
            padding: 15px 40px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: var(--gradient-1);
            color: var(--dark);
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(255,212,59,0.3);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--light);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        /* Quiz Screen */
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .category-badge {
            background: var(--gradient-1);
            color: var(--dark);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .question-counter {
            color: var(--light);
            font-size: 1rem;
        }

        .timer {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--secondary);
            font-size: 1.2rem;
            font-weight: 600;
        }

        .timer.warning {
            color: var(--danger);
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-1);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Question */
        .question-container {
            margin-bottom: 30px;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 15px;
        }

        .difficulty-easy {
            background: rgba(40, 167, 69, 0.2);
            color: var(--success);
        }

        .difficulty-medium {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .question-text {
            color: var(--light);
            font-size: 1.3rem;
            font-weight: 500;
            line-height: 1.6;
        }

        .code-block {
            background: #0d1117;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            color: #58a6ff;
            overflow-x: auto;
            border: 1px solid #30363d;
        }

        /* Answer Options */
        .answers-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .answer-option {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 18px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .answer-option:hover:not(.disabled) {
            border-color: var(--secondary);
            background: rgba(255,212,59,0.1);
            transform: translateX(10px);
        }

        .answer-option.selected {
            border-color: var(--primary);
            background: rgba(48,105,152,0.2);
        }

        .answer-option.correct {
            border-color: var(--success);
            background: rgba(40,167,69,0.2);
            animation: correctPulse 0.5s ease;
        }

        .answer-option.incorrect {
            border-color: var(--danger);
            background: rgba(220,53,69,0.2);
            animation: shake 0.5s ease;
        }

        .answer-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .answer-letter {
            width: 35px;
            height: 35px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--light);
            flex-shrink: 0;
        }

        .answer-option.correct .answer-letter {
            background: var(--success);
        }

        .answer-option.incorrect .answer-letter {
            background: var(--danger);
        }

        .answer-text {
            color: var(--light);
            font-size: 1rem;
            flex: 1;
        }

        .answer-icon {
            font-size: 1.2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .answer-option.correct .answer-icon,
        .answer-option.incorrect .answer-icon {
            opacity: 1;
        }

        /* Explanation */
        .explanation {
            background: rgba(48,105,152,0.2);
            border-left: 4px solid var(--primary);
            border-radius: 0 10px 10px 0;
            padding: 15px 20px;
            margin-top: 20px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .explanation h4 {
            color: var(--secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation p {
            color: #ccc;
            line-height: 1.6;
        }

        /* Navigation */
        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-btn {
            padding: 12px 30px;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn.prev {
            background: rgba(255,255,255,0.1);
            color: var(--light);
        }

        .nav-btn.next {
            background: var(--gradient-1);
            color: var(--dark);
        }

        .nav-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }

        /* Results Screen */
        .results-screen {
            text-align: center;
        }

        .results-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .results-icon.excellent {
            color: #ffd700;
            animation: spin 2s linear infinite;
        }

        .results-icon.good {
            color: var(--success);
        }

        .results-icon.average {
            color: var(--secondary);
        }

        .results-icon.poor {
            color: var(--danger);
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .results-title {
            color: var(--light);
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .results-subtitle {
            color: #888;
            margin-bottom: 30px;
        }

        .score-display {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--secondary) var(--percentage), rgba(255,255,255,0.1) 0);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 120px;
            height: 120px;
            background: var(--dark);
            border-radius: 50%;
        }

        .score-value {
            position: relative;
            z-index: 1;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--secondary);
        }

        .score-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .score-detail {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
        }

        .score-detail-value {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .score-detail-value.correct {
            color: var(--success);
        }

        .score-detail-value.incorrect {
            color: var(--danger);
        }

        .score-detail-value.skipped {
            color: #888;
        }

        .score-detail-label {
            color: #888;
            font-size: 0.9rem;
        }

        /* Category Progress */
        .category-progress {
            margin-top: 30px;
            text-align: left;
        }

        .category-progress h3 {
            color: var(--light);
            margin-bottom: 20px;
            text-align: center;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .progress-item-label {
            color: var(--light);
            width: 150px;
            font-size: 0.9rem;
        }

        .progress-item-bar {
            flex: 1;
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-item-fill {
            height: 100%;
            background: var(--gradient-1);
            border-radius: 5px;
            transition: width 1s ease;
        }

        .progress-item-value {
            color: var(--secondary);
            font-weight: 600;
            width: 50px;
            text-align: right;
        }

        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -350px;
            width: 350px;
            height: 100%;
            background: rgba(26,26,46,0.98);
            backdrop-filter: blur(10px);
            z-index: 1000;
            transition: right 0.3s ease;
            padding: 30px;
            overflow-y: auto;
            border-left: 1px solid rgba(255,255,255,0.1);
        }

        .settings-panel.open {
            right: 0;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .settings-header h3 {
            color: var(--light);
            font-size: 1.5rem;
        }

        .close-settings {
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .setting-group {
            margin-bottom: 25px;
        }

        .setting-group label {
            color: var(--light);
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .setting-group select,
        .setting-group input[type="range"] {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            color: var(--light);
            font-size: 1rem;
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.2);
            transition: 0.4s;
            border-radius: 30px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background: var(--secondary);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        /* Settings Button */
        .settings-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--light);
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 999;
            transition: all 0.3s ease;
        }

        .settings-btn:hover {
            background: var(--secondary);
            color: var(--dark);
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 4px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .logo h1 {
                font-size: 1.8rem;
            }

            .logo i {
                font-size: 2rem;
            }

            .stats-bar {
                gap: 15px;
            }

            .stat-value {
                font-size: 1.2rem;
            }

            .card {
                padding: 20px;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .category-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }

            .score-details {
                grid-template-columns: 1fr;
            }

            .settings-panel {
                width: 100%;
                right: -100%;
            }

            .quiz-navigation {
                justify-content: center;
            }
        }

        @media (orientation: landscape) and (max-height: 500px) {
            .container {
                padding: 10px;
            }

            .header {
                padding: 10px;
                margin-bottom: 10px;
            }

            .logo h1 {
                font-size: 1.5rem;
            }

            .python-icon {
                font-size: 3rem;
            }

            .category-grid {
                max-height: 200px;
            }

            .card {
                padding: 15px;
            }
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--dark);
            color: var(--light);
            padding: 15px 30px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            z-index: 2000;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .toast.success {
            border-color: var(--success);
        }

        .toast.error {
            border-color: var(--danger);
        }

        /* Confetti */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1500;
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-animation" id="bgAnimation"></div>

    <!-- Settings Button -->
    <button class="settings-btn" id="settingsBtn">
        <i class="fas fa-cog"></i>
    </button>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h3><i class="fas fa-cog"></i> Settings</h3>
            <button class="close-settings" id="closeSettings">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="setting-group">
            <label>Timer Duration (seconds)</label>
            <select id="timerDuration">
                <option value="0">No Timer</option>
                <option value="15">15 seconds</option>
                <option value="30" selected>30 seconds</option>
                <option value="45">45 seconds</option>
                <option value="60">60 seconds</option>
            </select>
        </div>

        <div class="setting-group">
            <label>Questions per Quiz</label>
            <select id="questionsPerQuiz">
                <option value="5">5 questions</option>
                <option value="10" selected>10 questions</option>
                <option value="15">15 questions</option>
                <option value="20">20 questions</option>
                <option value="0">All questions</option>
            </select>
        </div>

        <div class="setting-group">
            <div class="toggle-switch">
                <label>Show Explanations</label>
                <label class="switch">
                    <input type="checkbox" id="showExplanations" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="setting-group">
            <div class="toggle-switch">
                <label>Sound Effects</label>
                <label class="switch">
                    <input type="checkbox" id="soundEffects" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="setting-group">
            <div class="toggle-switch">
                <label>Dark Mode</label>
                <label class="switch">
                    <input type="checkbox" id="darkMode" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn btn-secondary" id="resetProgress">
                <i class="fas fa-redo"></i> Reset Progress
            </button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fab fa-python"></i>
                <h1>Python Quiz</h1>
            </div>
            <p class="subtitle">Master Python with 200 Questions</p>
        </header>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalScore">0</div>
                <div class="stat-label">Total Score</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="questionsAnswered">0</div>
                <div class="stat-label">Answered</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streak">0</div>
                <div class="stat-label">Streak</div>
            </div>
        </div>

        <!-- Welcome Screen -->
        <div class="card welcome-screen" id="welcomeScreen">
            <div class="python-icon">
                <i class="fab fa-python" style="color: #FFD43B;"></i>
            </div>
            <h2>Welcome to Python Quiz!</h2>
            <p>Test your Python knowledge with 200 questions across 20 categories. Select a category to begin!</p>
            
            <div class="category-grid" id="categoryGrid">
                <!-- Categories will be populated by JavaScript -->
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" id="startQuizBtn">
                    <i class="fas fa-play"></i> Start Quiz
                </button>
                <button class="btn btn-secondary" id="randomQuizBtn">
                    <i class="fas fa-random"></i> Random Mix
                </button>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div class="card quiz-screen hidden" id="quizScreen">
            <div class="quiz-header">
                <span class="category-badge" id="currentCategory">Category</span>
                <span class="question-counter" id="questionCounter">1/10</span>
                <div class="timer" id="timer">
                    <i class="fas fa-clock"></i>
                    <span id="timerValue">30</span>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>

            <div class="question-container">
                <span class="difficulty-badge" id="difficultyBadge">Easy</span>
                <p class="question-text" id="questionText">Question goes here?</p>
                <div class="code-block hidden" id="codeBlock"></div>
            </div>

            <div class="answers-container" id="answersContainer">
                <!-- Answers will be populated by JavaScript -->
            </div>

            <div class="explanation hidden" id="explanation">
                <h4><i class="fas fa-lightbulb"></i> Explanation</h4>
                <p id="explanationText"></p>
            </div>

            <div class="quiz-navigation">
                <button class="nav-btn prev" id="prevBtn">
                    <i class="fas fa-arrow-left"></i> Previous
                </button>
                <button class="nav-btn next" id="nextBtn">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div class="card results-screen hidden" id="resultsScreen">
            <div class="results-icon" id="resultsIcon">
                <i class="fas fa-trophy"></i>
            </div>
            <h2 class="results-title" id="resultsTitle">Great Job!</h2>
            <p class="results-subtitle" id="resultsSubtitle">You've completed the quiz</p>

            <div class="score-display">
                <div class="score-circle" id="scoreCircle" style="--percentage: 0%">
                    <span class="score-value" id="scorePercentage">0%</span>
                </div>
            </div>

            <div class="score-details">
                <div class="score-detail">
                    <div class="score-detail-value correct" id="correctCount">0</div>
                    <div class="score-detail-label">Correct</div>
                </div>
                <div class="score-detail">
                    <div class="score-detail-value incorrect" id="incorrectCount">0</div>
                    <div class="score-detail-label">Incorrect</div>
                </div>
                <div class="score-detail">
                    <div class="score-detail-value skipped" id="skippedCount">0</div>
                    <div class="score-detail-label">Skipped</div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" id="retryBtn">
                    <i class="fas fa-redo"></i> Try Again
                </button>
                <button class="btn btn-secondary" id="homeBtn">
                    <i class="fas fa-home"></i> Home
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Message</span>
    </div>

    <!-- Confetti Canvas -->
    <canvas class="confetti hidden" id="confetti"></canvas>

    <script>
        // ==================== QUESTION DATABASE ====================
        const questionDatabase = {
            // Category 1: Basic Syntax
            "Basic Syntax": [
                {
                    question: "What is the correct way to create a comment in Python?",
                    answers: ["// This is a comment", "# This is a comment", "/* This is a comment */", "-- This is a comment", "' This is a comment", "<!-- This is a comment -->", "** This is a comment **"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "In Python, single-line comments start with the hash symbol (#)."
                },
                {
                    question: "Which keyword is used to define a function in Python?",
                    answers: ["function", "def", "func", "define", "fn", "method", "sub"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'def' keyword is used to define functions in Python."
                },
                {
                    question: "What is the output of: print(type(5))?",
                    answers: ["<class 'int'>", "<class 'float'>", "<class 'number'>", "int", "integer", "<type 'int'>", "number"],
                    correct: 0,
                    difficulty: "easy",
                    explanation: "The type() function returns the type of an object. 5 is an integer, so it returns <class 'int'>."
                },
                {
                    question: "How do you create a multi-line string in Python?",
                    answers: ["Using backslash \\", "Using triple quotes '''", "Using double quotes \"\"", "Using parentheses ()", "Using brackets []", "Using semicolons ;", "Using plus signs +"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Triple quotes (''' or \"\"\") are used to create multi-line strings in Python."
                },
                {
                    question: "What symbol is used for exponentiation in Python?",
                    answers: ["^", "**", "^^", "exp()", "pow", "//", "%%"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The double asterisk (**) is used for exponentiation in Python. For example, 2**3 = 8."
                },
                {
                    question: "Which of the following is a valid variable name in Python?",
                    answers: ["2variable", "_variable", "variable-name", "class", "for", "import", "def"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Variable names can start with underscore or letter, but not with a number or be a reserved keyword."
                },
                {
                    question: "What is the correct file extension for Python files?",
                    answers: [".python", ".py", ".pt", ".pyt", ".p", ".pyth", ".pn"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Python files use the .py extension."
                },
                {
                    question: "How do you print 'Hello World' in Python 3?",
                    answers: ["echo 'Hello World'", "print('Hello World')", "console.log('Hello World')", "printf('Hello World')", "System.out.println('Hello World')", "cout << 'Hello World'", "puts 'Hello World'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "In Python 3, print() is a function that outputs text to the console."
                },
                {
                    question: "What does the 'pass' statement do in Python?",
                    answers: ["Exits the program", "Does nothing (placeholder)", "Passes a value", "Skips to next iteration", "Raises an error", "Returns None", "Breaks the loop"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The 'pass' statement is a null operation used as a placeholder when a statement is required syntactically."
                },
                {
                    question: "Which operator is used for floor division in Python?",
                    answers: ["/", "//", "%", "**", "\\\\", "div", "floor()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The // operator performs floor division, returning the largest integer less than or equal to the result."
                }
            ],

            // Category 2: Data Types
            "Data Types": [
                {
                    question: "Which of the following is NOT a built-in data type in Python?",
                    answers: ["int", "float", "array", "str", "list", "dict", "tuple"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "Array is not a built-in data type in Python. You need to import it from the array module or use NumPy."
                },
                {
                    question: "What is the result of type([1, 2, 3])?",
                    answers: ["<class 'array'>", "<class 'list'>", "<class 'tuple'>", "<class 'set'>", "<class 'dict'>", "<class 'sequence'>", "<class 'collection'>"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Square brackets [] create a list in Python."
                },
                {
                    question: "Which data type is immutable in Python?",
                    answers: ["list", "dict", "set", "tuple", "array", "deque", "defaultdict"],
                    correct: 3,
                    difficulty: "easy",
                    explanation: "Tuples are immutable in Python, meaning their values cannot be changed after creation."
                },
                {
                    question: "What is the boolean value of an empty list []?",
                    answers: ["True", "False", "None", "0", "Empty", "Null", "undefined"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Empty sequences (lists, strings, tuples) are considered False in a boolean context."
                },
                {
                    question: "How do you create a set in Python?",
                    answers: ["set = []", "set = {}", "set = ()", "set = set() or {1,2,3}", "set = <>", "set = ||", "set = [[]]"],
                    correct: 3,
                    difficulty: "medium",
                    explanation: "Sets are created using set() or curly braces with values {1,2,3}. Note: {} alone creates an empty dict."
                },
                {
                    question: "What is the result of 3 / 2 in Python 3?",
                    answers: ["1", "1.5", "1.0", "2", "Error", "None", "1.50"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "In Python 3, the / operator always returns a float. 3/2 = 1.5"
                },
                {
                    question: "Which type is used to store key-value pairs?",
                    answers: ["list", "tuple", "set", "dict", "array", "pair", "map"],
                    correct: 3,
                    difficulty: "easy",
                    explanation: "Dictionaries (dict) store key-value pairs in Python."
                },
                {
                    question: "What is the result of bool('False')?",
                    answers: ["False", "True", "Error", "None", "'False'", "0", "1"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Any non-empty string is True in Python, including the string 'False'."
                },
                {
                    question: "How do you convert a string '123' to an integer?",
                    answers: ["integer('123')", "int('123')", "str_to_int('123')", "convert('123')", "parse('123')", "Number('123')", "toInt('123')"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The int() function converts a string to an integer."
                },
                {
                    question: "What is the type of None in Python?",
                    answers: ["<class 'null'>", "<class 'NoneType'>", "<class 'void'>", "<class 'undefined'>", "<class 'empty'>", "<class 'nil'>", "<class 'nothing'>"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "None is of type NoneType in Python."
                }
            ],

            // Category 3: Strings
            "Strings": [
                {
                    question: "What method is used to convert a string to uppercase?",
                    answers: ["toUpperCase()", "upper()", "uppercase()", "toUpper()", "UPPER()", "capitalize()", "upcase()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The upper() method converts all characters in a string to uppercase."
                },
                {
                    question: "What is the output of 'Hello'[1]?",
                    answers: ["H", "e", "l", "He", "Error", "1", "ello"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "String indexing starts at 0, so 'Hello'[1] returns 'e'."
                },
                {
                    question: "How do you concatenate two strings in Python?",
                    answers: ["str1.concat(str2)", "str1 + str2", "str1.add(str2)", "concat(str1, str2)", "str1 & str2", "str1.join(str2)", "str1 . str2"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The + operator is used to concatenate strings in Python."
                },
                {
                    question: "What does 'Python'.find('th') return?",
                    answers: ["2", "3", "True", "-1", "th", "4", "1"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The find() method returns the index of the first occurrence. 'th' starts at index 2."
                },
                {
                    question: "What is the result of 'abc' * 3?",
                    answers: ["'abc3'", "'abcabcabc'", "Error", "9", "'abc abc abc'", "['abc','abc','abc']", "'aaa bbb ccc'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Multiplying a string by an integer repeats the string that many times."
                },
                {
                    question: "Which method removes whitespace from both ends of a string?",
                    answers: ["trim()", "strip()", "clean()", "remove()", "clear()", "cut()", "slice()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The strip() method removes leading and trailing whitespace from a string."
                },
                {
                    question: "What is the output of len('Hello World')?",
                    answers: ["10", "11", "12", "2", "Error", "HelloWorld", "9"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "len() returns the length of the string, including the space. 'Hello World' has 11 characters."
                },
                {
                    question: "How do you check if a string starts with 'Hello'?",
                    answers: ["str.begins('Hello')", "str.startsWith('Hello')", "str.startswith('Hello')", "str.start('Hello')", "str.prefix('Hello')", "str.first('Hello')", "str.head('Hello')"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "The startswith() method checks if a string starts with a specified prefix."
                },
                {
                    question: "What does 'Hello'.replace('l', 'x') return?",
                    answers: ["'Hexlo'", "'Hexxo'", "'Hexo'", "'Hello'", "'xello'", "'Hxllo'", "'Hellx'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The replace() method replaces all occurrences of the specified value."
                },
                {
                    question: "What is the result of 'Python'[-1]?",
                    answers: ["P", "n", "Error", "Python", "-1", "o", "1"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Negative indexing starts from the end. -1 refers to the last character 'n'."
                }
            ],

            // Category 4: Lists
            "Lists": [
                {
                    question: "How do you add an element to the end of a list?",
                    answers: ["list.add(x)", "list.append(x)", "list.insert(x)", "list.push(x)", "list.put(x)", "list += x", "list.extend(x)"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The append() method adds a single element to the end of a list."
                },
                {
                    question: "What is the output of [1, 2, 3] + [4, 5]?",
                    answers: ["[1, 2, 3, 4, 5]", "[5, 7, 3]", "Error", "[[1,2,3], [4,5]]", "[1, 2, 3, [4, 5]]", "15", "[4, 5, 1, 2, 3]"],
                    correct: 0,
                    difficulty: "easy",
                    explanation: "The + operator concatenates two lists into a new list."
                },
                {
                    question: "How do you remove the last element from a list?",
                    answers: ["list.remove()", "list.pop()", "list.delete()", "list.removeLast()", "del list[-1]", "list.drop()", "list.cut()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The pop() method removes and returns the last element by default."
                },
                {
                    question: "What does list.sort() return?",
                    answers: ["A sorted list", "None", "The original list", "A new list", "True", "The length", "An iterator"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The sort() method sorts the list in place and returns None."
                },
                {
                    question: "How do you get the length of a list?",
                    answers: ["list.length", "list.size()", "len(list)", "list.count()", "size(list)", "list.len()", "count(list)"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "The len() function returns the number of elements in a list."
                },
                {
                    question: "What is the result of [1, 2, 3][1:3]?",
                    answers: ["[1, 2]", "[2, 3]", "[1, 2, 3]", "[2]", "[1, 3]", "[3]", "Error"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Slicing [1:3] returns elements from index 1 up to (but not including) index 3."
                },
                {
                    question: "How do you reverse a list in place?",
                    answers: ["list.reverse()", "reversed(list)", "list[::-1]", "list.flip()", "reverse(list)", "list.invert()", "list.backwards()"],
                    correct: 0,
                    difficulty: "easy",
                    explanation: "The reverse() method reverses the list in place. reversed() returns an iterator."
                },
                {
                    question: "What does [1, 2, 2, 3].count(2) return?",
                    answers: ["1", "2", "3", "[2, 2]", "True", "4", "Error"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The count() method returns the number of times a value appears in the list."
                },
                {
                    question: "How do you create a copy of a list?",
                    answers: ["list2 = list1", "list2 = list1.copy()", "list2 = copy(list1)", "list2 = list1.clone()", "list2 = &list1", "list2 = *list1", "list2 = list1.dup()"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The copy() method creates a shallow copy. list2 = list1 only creates a reference."
                },
                {
                    question: "What is the output of [[1,2], [3,4]][0][1]?",
                    answers: ["1", "2", "[1, 2]", "3", "[3, 4]", "Error", "[[1,2]]"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "[0] gets the first inner list [1,2], then [1] gets the second element which is 2."
                }
            ],

            // Category 5: Dictionaries
            "Dictionaries": [
                {
                    question: "How do you access a value in a dictionary?",
                    answers: ["dict.value", "dict[key]", "dict.get[key]", "dict->key", "dict.key()", "dict(key)", "dict{key}"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Dictionary values are accessed using square brackets with the key: dict[key]"
                },
                {
                    question: "What method returns all keys in a dictionary?",
                    answers: ["dict.allKeys()", "dict.keys()", "dict.getKeys()", "keys(dict)", "dict.keySet()", "dict.key()", "dict.listKeys()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The keys() method returns a view object containing all keys in the dictionary."
                },
                {
                    question: "How do you add a new key-value pair to a dictionary?",
                    answers: ["dict.add(key, value)", "dict[key] = value", "dict.put(key, value)", "dict.insert(key, value)", "dict.set(key, value)", "dict.append(key, value)", "dict.new(key, value)"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "New key-value pairs are added using dict[key] = value syntax."
                },
                {
                    question: "What does dict.get('key', 'default') return if 'key' doesn't exist?",
                    answers: ["None", "'default'", "Error", "False", "0", "''", "KeyError"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The get() method returns the default value if the key is not found."
                },
                {
                    question: "How do you remove a key from a dictionary?",
                    answers: ["dict.remove('key')", "del dict['key']", "dict.delete('key')", "dict.drop('key')", "dict.unset('key')", "dict.clear('key')", "dict.erase('key')"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The del statement removes a key-value pair from a dictionary."
                },
                {
                    question: "What is the result of len({'a': 1, 'b': 2, 'c': 3})?",
                    answers: ["6", "3", "9", "Error", "{'a','b','c'}", "[1,2,3]", "2"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "len() returns the number of key-value pairs in the dictionary."
                },
                {
                    question: "Which method returns key-value pairs as tuples?",
                    answers: ["dict.pairs()", "dict.items()", "dict.tuples()", "dict.entries()", "dict.keyValues()", "dict.all()", "dict.both()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The items() method returns a view of key-value pairs as tuples."
                },
                {
                    question: "What happens when you access a non-existent key with dict['key']?",
                    answers: ["Returns None", "Returns ''", "Raises KeyError", "Returns False", "Creates the key", "Returns 0", "Raises ValueError"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "Accessing a non-existent key with [] raises a KeyError. Use get() to avoid this."
                },
                {
                    question: "How do you merge two dictionaries in Python 3.9+?",
                    answers: ["dict1.merge(dict2)", "dict1 + dict2", "dict1 | dict2", "dict1.update(dict2)", "merge(dict1, dict2)", "dict1 & dict2", "dict1.combine(dict2)"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "Python 3.9+ supports the | operator for dictionary merging."
                },
                {
                    question: "What does dict.pop('key') do?",
                    answers: ["Returns the key", "Removes and returns the value", "Removes the last item", "Returns True if exists", "Raises an error", "Returns the dictionary", "Clears the dictionary"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The pop() method removes the specified key and returns its value."
                }
            ],

            // Category 6: Tuples
            "Tuples": [
                {
                    question: "How do you create a tuple with one element?",
                    answers: ["(1)", "(1,)", "[1]", "{1}", "tuple(1)", "<1>", "((1))"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "A single-element tuple requires a trailing comma: (1,). Without it, (1) is just an integer."
                },
                {
                    question: "Can you modify elements in a tuple?",
                    answers: ["Yes, using index", "No, tuples are immutable", "Yes, using update()", "Yes, using modify()", "Only the first element", "Only with special methods", "Yes, using set()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Tuples are immutable, meaning their elements cannot be changed after creation."
                },
                {
                    question: "What is the result of (1, 2) + (3, 4)?",
                    answers: ["(4, 6)", "(1, 2, 3, 4)", "Error", "((1,2), (3,4))", "[1, 2, 3, 4]", "10", "(1, 2, (3, 4))"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The + operator concatenates tuples, creating a new tuple."
                },
                {
                    question: "How do you unpack a tuple (a, b) = (1, 2)?",
                    answers: ["a = 1, b = 2", "a becomes 1, b becomes 2", "Error", "a = (1, 2)", "b = (1, 2)", "Both become (1, 2)", "a = 2, b = 1"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Tuple unpacking assigns each element to the corresponding variable."
                },
                {
                    question: "What method counts occurrences in a tuple?",
                    answers: ["tuple.find()", "tuple.count()", "tuple.search()", "tuple.occurrences()", "count(tuple)", "tuple.num()", "tuple.frequency()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The count() method returns the number of times a value appears in the tuple."
                },
                {
                    question: "What is the output of tuple([1, 2, 3])?",
                    answers: ["[1, 2, 3]", "(1, 2, 3)", "Error", "{1, 2, 3}", "((1, 2, 3))", "1, 2, 3", "[tuple]"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The tuple() function converts a list to a tuple."
                },
                {
                    question: "How do you find the index of an element in a tuple?",
                    answers: ["tuple.find(x)", "tuple.index(x)", "tuple.search(x)", "tuple.locate(x)", "index(tuple, x)", "tuple.position(x)", "tuple.where(x)"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The index() method returns the index of the first occurrence of the specified value."
                },
                {
                    question: "What is the result of (1, 2, 3) * 2?",
                    answers: ["(2, 4, 6)", "(1, 2, 3, 1, 2, 3)", "Error", "((1,2,3), (1,2,3))", "12", "(1, 2, 3, 2)", "[1, 2, 3, 1, 2, 3]"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Multiplying a tuple by an integer repeats the tuple."
                },
                {
                    question: "Can a tuple contain mutable objects?",
                    answers: ["No, never", "Yes, like lists", "Only strings", "Only numbers", "Only other tuples", "Only dictionaries", "Only sets"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Tuples can contain mutable objects like lists. The tuple itself is immutable, but its mutable contents can change."
                },
                {
                    question: "What is the output of len((1, 2, (3, 4)))?",
                    answers: ["4", "3", "2", "5", "Error", "6", "1"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The tuple has 3 elements: 1, 2, and the nested tuple (3, 4)."
                }
            ],

            // Category 7: Control Flow
            "Control Flow": [
                {
                    question: "What keyword is used for conditional statements in Python?",
                    answers: ["when", "if", "case", "switch", "condition", "check", "test"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'if' keyword is used for conditional statements in Python."
                },
                {
                    question: "What is the correct syntax for an else-if statement?",
                    answers: ["else if:", "elseif:", "elif:", "elsif:", "otherwise:", "elseif():", "else-if:"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "Python uses 'elif' for else-if statements."
                },
                {
                    question: "What does 'break' do in a loop?",
                    answers: ["Pauses the loop", "Exits the loop immediately", "Skips to next iteration", "Restarts the loop", "Raises an error", "Does nothing", "Breaks the program"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'break' statement immediately exits the innermost loop."
                },
                {
                    question: "What does 'continue' do in a loop?",
                    answers: ["Exits the loop", "Skips to next iteration", "Pauses the loop", "Restarts from beginning", "Continues after loop", "Raises an error", "Does nothing"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'continue' statement skips the rest of the current iteration and moves to the next."
                },
                {
                    question: "Which loop is used when the number of iterations is known?",
                    answers: ["while loop", "for loop", "do-while loop", "repeat loop", "until loop", "foreach loop", "loop loop"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "For loops are typically used when the number of iterations is known in advance."
                },
                {
                    question: "What is the output of: for i in range(3): print(i)",
                    answers: ["1 2 3", "0 1 2", "0 1 2 3", "1 2", "Error", "3 2 1", "0 0 0"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "range(3) generates 0, 1, 2. Python ranges start at 0 by default."
                },
                {
                    question: "What is the ternary operator syntax in Python?",
                    answers: ["condition ? true : false", "true if condition else false", "if condition then true else false", "condition && true || false", "(condition) ? true : false", "true when condition else false", "condition : true ? false"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Python's ternary operator syntax is: value_if_true if condition else value_if_false"
                },
                {
                    question: "What happens if a while loop condition is always True?",
                    answers: ["Error", "Infinite loop", "Runs once", "Skips the loop", "Returns True", "Raises exception", "Terminates immediately"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "A while True loop runs indefinitely unless broken by a break statement or exception."
                },
                {
                    question: "What does range(2, 10, 2) generate?",
                    answers: ["2, 4, 6, 8", "2, 4, 6, 8, 10", "0, 2, 4, 6, 8", "2, 3, 4, 5, 6, 7, 8, 9", "10, 8, 6, 4, 2", "2, 10, 2", "Error"],
                    correct: 0,
                    difficulty: "medium",
                    explanation: "range(start, stop, step) generates numbers from 2 to 10 (exclusive) with step 2."
                },
                {
                    question: "Can you use 'else' with a for loop?",
                    answers: ["No, syntax error", "Yes, runs if loop completes normally", "Yes, runs if loop breaks", "Yes, runs every iteration", "Only with while loops", "Only in Python 2", "Only with nested loops"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The else clause in a for loop executes when the loop completes without hitting a break."
                }
            ],

            // Category 8: Functions
            "Functions": [
                {
                    question: "How do you define a function that takes no arguments?",
                    answers: ["def func:", "def func():", "function func():", "func() = :", "define func():", "def func[] :", "func():"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Functions are defined with 'def' followed by the function name and parentheses."
                },
                {
                    question: "What is a default parameter value?",
                    answers: ["A required parameter", "A value used if no argument is passed", "The first parameter", "A global variable", "A return value", "A local variable", "A constant"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Default parameters have preset values used when no argument is provided."
                },
                {
                    question: "What does *args represent in a function definition?",
                    answers: ["A required argument", "Variable positional arguments", "A keyword argument", "A default value", "An error", "A pointer", "A reference"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "*args allows a function to accept any number of positional arguments as a tuple."
                },
                {
                    question: "What does **kwargs represent?",
                    answers: ["Positional arguments", "Variable keyword arguments", "A syntax error", "A dictionary literal", "A class method", "A decorator", "A generator"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "**kwargs allows a function to accept any number of keyword arguments as a dictionary."
                },
                {
                    question: "What is returned if a function has no return statement?",
                    answers: ["0", "None", "Empty string", "False", "Error", "Undefined", "The function itself"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Functions without a return statement implicitly return None."
                },
                {
                    question: "What is a lambda function?",
                    answers: ["A named function", "An anonymous function", "A recursive function", "A generator function", "A class method", "A built-in function", "A decorator"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Lambda functions are small anonymous functions defined with the lambda keyword."
                },
                {
                    question: "What is the correct lambda syntax for adding two numbers?",
                    answers: ["lambda: x + y", "lambda x, y: x + y", "lambda(x, y) x + y", "def lambda(x, y): x + y", "lambda x y: x + y", "lambda(x, y): x + y", "x, y => x + y"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Lambda syntax: lambda parameters: expression"
                },
                {
                    question: "What is a recursive function?",
                    answers: ["A function that runs forever", "A function that calls itself", "A function with no parameters", "A function that returns a list", "A function with default values", "A function with *args", "A function with decorators"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "A recursive function is one that calls itself to solve smaller instances of a problem."
                },
                {
                    question: "What is the scope of a variable defined inside a function?",
                    answers: ["Global", "Local", "Universal", "Module", "Class", "Instance", "Static"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Variables defined inside a function have local scope and are only accessible within that function."
                },
                {
                    question: "How do you access a global variable inside a function?",
                    answers: ["Using 'global' keyword", "Using 'extern' keyword", "Using 'public' keyword", "Automatically accessible", "Using 'import' keyword", "Using 'access' keyword", "Using 'use' keyword"],
                    correct: 0,
                    difficulty: "medium",
                    explanation: "The 'global' keyword is used to modify a global variable inside a function."
                }
            ],

            // Category 9: Modules & Imports
            "Modules & Imports": [
                {
                    question: "How do you import a module named 'math'?",
                    answers: ["include math", "import math", "require math", "using math", "load math", "#include math", "from math"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'import' statement is used to import modules in Python."
                },
                {
                    question: "How do you import only the 'sqrt' function from math?",
                    answers: ["import sqrt from math", "from math import sqrt", "import math.sqrt", "using math.sqrt", "include math.sqrt", "require math.sqrt", "math import sqrt"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'from module import function' syntax imports specific items."
                },
                {
                    question: "What does 'import math as m' do?",
                    answers: ["Renames the module", "Creates an alias 'm' for math", "Imports only 'm' function", "Creates a copy of math", "Deletes math module", "Imports math twice", "Creates a submodule"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'as' keyword creates an alias for the imported module."
                },
                {
                    question: "What does 'from math import *' do?",
                    answers: ["Imports nothing", "Imports all public names", "Imports the module", "Creates an error", "Imports private names", "Imports documentation", "Imports metadata"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The asterisk (*) imports all public names from the module (not recommended)."
                },
                {
                    question: "Where does Python look for modules?",
                    answers: ["Only current directory", "Only Python installation", "sys.path locations", "Only home directory", "Only /usr/lib", "Only environment variables", "Only PATH variable"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "Python searches for modules in directories listed in sys.path."
                },
                {
                    question: "What file makes a directory a Python package?",
                    answers: ["__main__.py", "__init__.py", "setup.py", "package.py", "module.py", "config.py", "__package__.py"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The __init__.py file (can be empty) marks a directory as a Python package."
                },
                {
                    question: "How do you reload a module that's already imported?",
                    answers: ["reload(module)", "import module again", "from importlib import reload; reload(module)", "module.reload()", "reimport module", "refresh(module)", "update(module)"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "Use importlib.reload() to reload a module in Python 3."
                },
                {
                    question: "What is the purpose of __name__ == '__main__'?",
                    answers: ["Defines the main function", "Checks if script is run directly", "Creates the main module", "Imports the main module", "Defines a class", "Creates a package", "Exports functions"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "This idiom checks if the script is being run directly (not imported)."
                },
                {
                    question: "Which module provides mathematical functions?",
                    answers: ["numbers", "math", "calc", "arithmetic", "maths", "numerical", "compute"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'math' module provides mathematical functions like sqrt, sin, cos, etc."
                },
                {
                    question: "Which module is used for working with dates and times?",
                    answers: ["time", "datetime", "date", "calendar", "clock", "timestamp", "moment"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'datetime' module provides classes for working with dates and times."
                }
            ],

            // Category 10: File Handling
            "File Handling": [
                {
                    question: "How do you open a file for reading in Python?",
                    answers: ["file.open('file.txt')", "open('file.txt', 'r')", "read('file.txt')", "File('file.txt')", "load('file.txt')", "get('file.txt')", "input('file.txt')"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The open() function with 'r' mode opens a file for reading."
                },
                {
                    question: "What mode is used to write to a file (overwriting)?",
                    answers: ["'r'", "'w'", "'a'", "'x'", "'rw'", "'o'", "'wr'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'w' mode opens a file for writing, creating it if it doesn't exist and overwriting if it does."
                },
                {
                    question: "What mode is used to append to a file?",
                    answers: ["'r'", "'w'", "'a'", "'x'", "'+'", "'e'", "'add'"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "The 'a' mode opens a file for appending (adding to the end)."
                },
                {
                    question: "What is the recommended way to open files?",
                    answers: ["Using open() directly", "Using with statement", "Using try-finally", "Using file class", "Using io module", "Using os module", "Using sys module"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'with' statement ensures proper file handling and automatic closing."
                },
                {
                    question: "What method reads the entire file content?",
                    answers: ["file.readAll()", "file.read()", "file.content()", "file.get()", "file.load()", "file.fetch()", "file.data()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The read() method reads the entire file content as a string."
                },
                {
                    question: "What method reads one line from a file?",
                    answers: ["file.read(1)", "file.readline()", "file.getline()", "file.line()", "file.nextline()", "file.readLine()", "file.fetchline()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The readline() method reads a single line from the file."
                },
                {
                    question: "What method reads all lines into a list?",
                    answers: ["file.read()", "file.readlines()", "file.lines()", "file.getlines()", "file.alllines()", "file.tolist()", "file.readAll()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The readlines() method reads all lines and returns them as a list."
                },
                {
                    question: "How do you write to a file?",
                    answers: ["file.put('text')", "file.write('text')", "file.output('text')", "file.print('text')", "file.save('text')", "file.add('text')", "file.insert('text')"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The write() method writes a string to the file."
                },
                {
                    question: "What does file.close() do?",
                    answers: ["Deletes the file", "Closes the file handle", "Saves the file", "Clears the file", "Locks the file", "Encrypts the file", "Compresses the file"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The close() method closes the file and releases system resources."
                },
                {
                    question: "What mode opens a file for both reading and writing?",
                    answers: ["'rw'", "'r+'", "'wr'", "'+'", "'rw+'", "'both'", "'dual'"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The 'r+' mode opens a file for both reading and writing."
                }
            ],

            // Category 11: Exception Handling
            "Exception Handling": [
                {
                    question: "What keyword is used to handle exceptions?",
                    answers: ["catch", "try", "handle", "error", "exception", "rescue", "trap"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'try' keyword starts a block that may raise exceptions."
                },
                {
                    question: "What keyword catches an exception?",
                    answers: ["catch", "except", "handle", "error", "grab", "get", "receive"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'except' keyword is used to catch and handle exceptions."
                },
                {
                    question: "What keyword runs code regardless of exceptions?",
                    answers: ["always", "finally", "ensure", "cleanup", "after", "end", "complete"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'finally' block always executes, whether an exception occurred or not."
                },
                {
                    question: "How do you manually raise an exception?",
                    answers: ["throw Exception()", "raise Exception()", "error Exception()", "exception()", "trigger Exception()", "create Exception()", "new Exception()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'raise' keyword is used to manually raise an exception."
                },
                {
                    question: "What exception is raised for division by zero?",
                    answers: ["DivisionError", "ZeroDivisionError", "MathError", "ArithmeticError", "DivideByZeroError", "ZeroError", "DivError"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "ZeroDivisionError is raised when dividing by zero."
                },
                {
                    question: "What exception is raised for invalid type operations?",
                    answers: ["InvalidTypeError", "TypeError", "TypeMismatchError", "WrongTypeError", "BadTypeError", "TypeException", "InvalidError"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "TypeError is raised when an operation is applied to an inappropriate type."
                },
                {
                    question: "What exception is raised for invalid index access?",
                    answers: ["InvalidIndexError", "IndexError", "OutOfBoundsError", "ArrayIndexError", "BoundsError", "RangeError", "AccessError"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "IndexError is raised when a sequence index is out of range."
                },
                {
                    question: "How do you catch multiple exception types?",
                    answers: ["except Error1, Error2:", "except (Error1, Error2):", "except Error1 or Error2:", "except Error1 and Error2:", "except [Error1, Error2]:", "except Error1 | Error2:", "catch Error1, Error2:"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Multiple exceptions are caught using a tuple: except (Error1, Error2):"
                },
                {
                    question: "What is the base class for all exceptions?",
                    answers: ["Error", "Exception", "BaseException", "Throwable", "ExceptionBase", "RootException", "MainException"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "BaseException is the base class for all built-in exceptions."
                },
                {
                    question: "What does 'else' do in try-except?",
                    answers: ["Runs if exception occurs", "Runs if no exception occurs", "Always runs", "Catches remaining exceptions", "Runs before try", "Runs after finally", "Does nothing"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The 'else' block runs only if no exception was raised in the try block."
                }
            ],

            // Category 12: Object-Oriented Programming
            "OOP Basics": [
                {
                    question: "What keyword is used to define a class?",
                    answers: ["define", "class", "struct", "object", "type", "new", "create"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'class' keyword is used to define a class in Python."
                },
                {
                    question: "What is the first parameter of instance methods?",
                    answers: ["this", "self", "me", "instance", "object", "cls", "that"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "By convention, 'self' is the first parameter of instance methods, referring to the instance."
                },
                {
                    question: "What method is called when an object is created?",
                    answers: ["__create__", "__init__", "__new__", "__start__", "__begin__", "__construct__", "__make__"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The __init__ method is the constructor, called when an object is created."
                },
                {
                    question: "How do you create an instance of a class?",
                    answers: ["new ClassName()", "ClassName.new()", "ClassName()", "create ClassName()", "instance ClassName()", "make ClassName()", "build ClassName()"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "Objects are created by calling the class name like a function: ClassName()"
                },
                {
                    question: "What is inheritance in OOP?",
                    answers: ["Copying code", "A class deriving from another", "Creating objects", "Defining methods", "Using modules", "Exception handling", "File operations"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Inheritance allows a class to inherit attributes and methods from another class."
                },
                {
                    question: "How do you inherit from a parent class?",
                    answers: ["class Child extends Parent:", "class Child(Parent):", "class Child inherits Parent:", "class Child : Parent:", "class Child <- Parent:", "class Child from Parent:", "class Child < Parent:"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "In Python, inheritance is specified by putting the parent class in parentheses."
                },
                {
                    question: "What does super() do?",
                    answers: ["Creates a superclass", "Calls parent class methods", "Makes a method public", "Deletes the parent", "Creates a new class", "Overrides methods", "Hides methods"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "super() returns a proxy object that delegates method calls to the parent class."
                },
                {
                    question: "What is encapsulation?",
                    answers: ["Hiding internal details", "Creating multiple objects", "Inheriting from classes", "Overriding methods", "Using decorators", "Importing modules", "Handling exceptions"],
                    correct: 0,
                    difficulty: "easy",
                    explanation: "Encapsulation is the bundling of data and methods, hiding internal implementation details."
                },
                {
                    question: "How do you make an attribute private by convention?",
                    answers: ["private attr", "attr.private", "_attr or __attr", "#attr", "@attr", "~attr", "$attr"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "Single underscore (_attr) suggests private, double underscore (__attr) triggers name mangling."
                },
                {
                    question: "What is polymorphism?",
                    answers: ["Multiple inheritance", "Same interface, different implementations", "Creating objects", "Hiding data", "Using decorators", "Exception handling", "File operations"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Polymorphism allows objects of different classes to be treated through the same interface."
                }
            ],

            // Category 13: List Comprehensions
            "List Comprehensions": [
                {
                    question: "What is the basic syntax of a list comprehension?",
                    answers: ["[for x in list: x]", "[x for x in list]", "[x: for x in list]", "for x in list: [x]", "[x in list for x]", "list[x for x]", "{x for x in list}"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "List comprehension syntax: [expression for item in iterable]"
                },
                {
                    question: "What is the output of [x*2 for x in [1,2,3]]?",
                    answers: ["[1, 2, 3]", "[2, 4, 6]", "[1, 4, 9]", "[2, 2, 2]", "6", "[1, 2, 3, 1, 2, 3]", "Error"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Each element is multiplied by 2: 1*2=2, 2*2=4, 3*2=6"
                },
                {
                    question: "How do you add a condition to a list comprehension?",
                    answers: ["[x for x in list where condition]", "[x for x in list if condition]", "[x if condition for x in list]", "[x for x in list when condition]", "[x for x in list ? condition]", "[if condition x for x in list]", "[x for x in list and condition]"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Conditions are added at the end: [x for x in list if condition]"
                },
                {
                    question: "What is [x for x in range(10) if x % 2 == 0]?",
                    answers: ["[1, 3, 5, 7, 9]", "[0, 2, 4, 6, 8]", "[2, 4, 6, 8, 10]", "[0, 1, 2, 3, 4]", "[0, 2, 4, 6, 8, 10]", "[1, 2, 3, 4, 5]", "Error"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "This filters even numbers from 0-9: 0, 2, 4, 6, 8"
                },
                {
                    question: "What is a nested list comprehension?",
                    answers: ["A comprehension with errors", "A comprehension inside another", "A comprehension with functions", "A comprehension with classes", "A comprehension with files", "A comprehension with exceptions", "A comprehension with modules"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Nested list comprehensions have one comprehension inside another."
                },
                {
                    question: "What is [[j for j in range(3)] for i in range(2)]?",
                    answers: ["[0, 1, 2, 0, 1, 2]", "[[0, 1, 2], [0, 1, 2]]", "[[0, 1], [0, 1], [0, 1]]", "[0, 1, 2]", "[[0, 0], [1, 1], [2, 2]]", "Error", "[[0], [1], [2]]"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Creates 2 lists, each containing [0, 1, 2]"
                },
                {
                    question: "What is the dictionary comprehension syntax?",
                    answers: ["[key: value for item in list]", "{key: value for item in list}", "(key: value for item in list)", "<key: value for item in list>", "dict(key: value for item in list)", "{key, value for item in list}", "[key, value for item in list]"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Dictionary comprehensions use curly braces: {key: value for item in iterable}"
                },
                {
                    question: "What is {x: x**2 for x in range(4)}?",
                    answers: ["{0: 0, 1: 1, 2: 4, 3: 9}", "[0, 1, 4, 9]", "{0, 1, 4, 9}", "(0, 1, 4, 9)", "{1: 1, 2: 4, 3: 9, 4: 16}", "Error", "{0: 1, 1: 2, 2: 3, 3: 4}"],
                    correct: 0,
                    difficulty: "medium",
                    explanation: "Creates a dictionary mapping numbers to their squares: 0:0, 1:1, 2:4, 3:9"
                },
                {
                    question: "What is a set comprehension?",
                    answers: ["[x for x in list]", "{x for x in list}", "(x for x in list)", "<x for x in list>", "set[x for x in list]", "{{x for x in list}}", "set(x for x in list)"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Set comprehensions use curly braces without colons: {x for x in iterable}"
                },
                {
                    question: "What is the output of [x.upper() for x in 'abc']?",
                    answers: ["'ABC'", "['A', 'B', 'C']", "['a', 'b', 'c']", "['ABC']", "ABC", "Error", "('A', 'B', 'C')"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Iterates over each character and converts to uppercase."
                }
            ],

            // Category 14: Built-in Functions
            "Built-in Functions": [
                {
                    question: "What does len() return?",
                    answers: ["The type of object", "The length/size of object", "The value of object", "The id of object", "The hash of object", "The string of object", "The bytes of object"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "len() returns the number of items in an object."
                },
                {
                    question: "What does max([1, 5, 3, 2]) return?",
                    answers: ["1", "5", "3", "[5]", "4", "Error", "2"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "max() returns the largest item in an iterable."
                },
                {
                    question: "What does min([1, 5, 3, 2]) return?",
                    answers: ["1", "5", "3", "[1]", "0", "Error", "2"],
                    correct: 0,
                    difficulty: "easy",
                    explanation: "min() returns the smallest item in an iterable."
                },
                {
                    question: "What does sum([1, 2, 3, 4]) return?",
                    answers: ["4", "10", "[10]", "1234", "Error", "2.5", "24"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "sum() returns the sum of all items in an iterable."
                },
                {
                    question: "What does abs(-5) return?",
                    answers: ["-5", "5", "0", "Error", "-1", "1", "25"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "abs() returns the absolute value of a number."
                },
                {
                    question: "What does round(3.7) return?",
                    answers: ["3", "4", "3.7", "3.0", "4.0", "Error", "3.70"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "round() rounds a number to the nearest integer."
                },
                {
                    question: "What does sorted([3, 1, 2]) return?",
                    answers: ["[3, 1, 2]", "[1, 2, 3]", "[3, 2, 1]", "None", "[1, 3, 2]", "Error", "(1, 2, 3)"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "sorted() returns a new sorted list from the iterable."
                },
                {
                    question: "What does enumerate(['a', 'b', 'c']) produce?",
                    answers: ["['a', 'b', 'c']", "[(0,'a'), (1,'b'), (2,'c')]", "[0, 1, 2]", "{'a':0, 'b':1, 'c':2}", "('a', 'b', 'c')", "Error", "[('a',0), ('b',1), ('c',2)]"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "enumerate() returns an iterator of tuples with index and value."
                },
                {
                    question: "What does zip([1,2], ['a','b']) produce?",
                    answers: ["[(1,'a'), (2,'b')]", "[1, 2, 'a', 'b']", "[[1,2], ['a','b']]", "{1:'a', 2:'b'}", "Error", "[(1,2), ('a','b')]", "[('a',1), ('b',2)]"],
                    correct: 0,
                    difficulty: "medium",
                    explanation: "zip() combines iterables element-wise into tuples."
                },
                {
                    question: "What does map(str, [1, 2, 3]) return?",
                    answers: ["['1', '2', '3']", "A map object", "'123'", "[1, 2, 3]", "Error", "('1', '2', '3')", "str([1, 2, 3])"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "map() returns a map object (iterator) that applies the function to each item."
                }
            ],

            // Category 15: String Methods
            "String Methods": [
                {
                    question: "What does 'hello'.capitalize() return?",
                    answers: ["'HELLO'", "'Hello'", "'hello'", "'hELLO'", "'HeLLo'", "Error", "'hEllo'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "capitalize() returns the string with the first character capitalized."
                },
                {
                    question: "What does 'Hello World'.split() return?",
                    answers: ["'Hello World'", "['Hello', 'World']", "['H','e','l','l','o',' ','W','o','r','l','d']", "('Hello', 'World')", "2", "Error", "['Hello World']"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "split() without arguments splits on whitespace."
                },
                {
                    question: "What does ' '.join(['a', 'b', 'c']) return?",
                    answers: ["'abc'", "'a b c'", "['a', 'b', 'c']", "'a, b, c'", "' abc '", "Error", "('a', 'b', 'c')"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "join() concatenates list elements with the specified separator."
                },
                {
                    question: "What does 'Python'.lower() return?",
                    answers: ["'PYTHON'", "'python'", "'Python'", "'pYTHON'", "Error", "'Pythonlower'", "'pythonlower'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "lower() returns the string in all lowercase."
                },
                {
                    question: "What does '  hello  '.strip() return?",
                    answers: ["'  hello  '", "'hello'", "'hello  '", "'  hello'", "'h e l l o'", "Error", "'   hello   '"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "strip() removes leading and trailing whitespace."
                },
                {
                    question: "What does 'hello'.isalpha() return?",
                    answers: ["'hello'", "True", "False", "5", "Error", "None", "'alpha'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "isalpha() returns True if all characters are alphabetic."
                },
                {
                    question: "What does '123'.isdigit() return?",
                    answers: ["123", "True", "False", "'123'", "Error", "3", "None"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "isdigit() returns True if all characters are digits."
                },
                {
                    question: "What does 'hello world'.title() return?",
                    answers: ["'HELLO WORLD'", "'Hello World'", "'hello world'", "'Hello world'", "'hELLO wORLD'", "Error", "'HeLLo WoRLd'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "title() returns the string with each word capitalized."
                },
                {
                    question: "What does 'abc'.center(7) return?",
                    answers: ["'abc'", "'  abc  '", "'abc    '", "'    abc'", "'abcabca'", "Error", "'  abc '"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "center() returns the string centered in a string of specified length."
                },
                {
                    question: "What does 'hello'.count('l') return?",
                    answers: ["1", "2", "3", "'ll'", "True", "Error", "[2, 3]"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "count() returns the number of occurrences of a substring."
                }
            ],

            // Category 16: Operators
            "Operators": [
                {
                    question: "What is the result of 5 == 5?",
                    answers: ["5", "True", "False", "10", "Error", "None", "'5'"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The == operator compares values and returns True if equal."
                },
                {
                    question: "What is the result of 5 != 3?",
                    answers: ["5", "True", "False", "2", "Error", "None", "8"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The != operator returns True if values are not equal."
                },
                {
                    question: "What does 'and' operator do?",
                    answers: ["Adds values", "Returns True if both are True", "Returns True if either is True", "Negates value", "Compares values", "Divides values", "Multiplies values"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'and' operator returns True only if both operands are True."
                },
                {
                    question: "What does 'or' operator do?",
                    answers: ["Adds values", "Returns True if both are True", "Returns True if either is True", "Negates value", "Compares values", "Divides values", "Multiplies values"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "The 'or' operator returns True if at least one operand is True."
                },
                {
                    question: "What does 'not' operator do?",
                    answers: ["Adds values", "Returns True if both are True", "Returns True if either is True", "Negates boolean value", "Compares values", "Divides values", "Multiplies values"],
                    correct: 3,
                    difficulty: "easy",
                    explanation: "The 'not' operator negates a boolean value."
                },
                {
                    question: "What is the result of 10 % 3?",
                    answers: ["3", "1", "0", "3.33", "10", "Error", "30"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The % operator returns the remainder of division. 10  3 = 3 remainder 1."
                },
                {
                    question: "What does 'is' operator check?",
                    answers: ["Value equality", "Identity (same object)", "Type equality", "String equality", "Numeric equality", "List equality", "Dict equality"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The 'is' operator checks if two variables refer to the same object in memory."
                },
                {
                    question: "What is the result of 2 ** 3?",
                    answers: ["6", "8", "5", "23", "Error", "9", "1"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The ** operator performs exponentiation. 2 = 8."
                },
                {
                    question: "What does 'in' operator check?",
                    answers: ["Identity", "Membership in sequence", "Type", "Value", "Length", "Index", "Hash"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'in' operator checks if a value exists in a sequence."
                },
                {
                    question: "What is the result of 7 // 2?",
                    answers: ["3.5", "3", "4", "3.0", "Error", "2", "1"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The // operator performs floor division, returning the integer part."
                }
            ],

            // Category 17: Iterators & Generators
            "Iterators & Generators": [
                {
                    question: "What is an iterator in Python?",
                    answers: ["A loop", "An object that can be iterated", "A function", "A class", "A module", "A variable", "A constant"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "An iterator is an object that implements __iter__ and __next__ methods."
                },
                {
                    question: "What function returns an iterator from an iterable?",
                    answers: ["iterate()", "iter()", "iterator()", "next()", "loop()", "for()", "each()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The iter() function returns an iterator object from an iterable."
                },
                {
                    question: "What function gets the next item from an iterator?",
                    answers: ["get()", "next()", "fetch()", "item()", "advance()", "forward()", "step()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The next() function retrieves the next item from an iterator."
                },
                {
                    question: "What keyword is used to create a generator function?",
                    answers: ["generate", "yield", "return", "give", "produce", "emit", "output"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'yield' keyword is used in generator functions to yield values."
                },
                {
                    question: "What is a generator expression?",
                    answers: ["A list comprehension", "A comprehension with parentheses", "A dictionary comprehension", "A set comprehension", "A tuple comprehension", "A function call", "A class definition"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Generator expressions use parentheses: (x for x in iterable)"
                },
                {
                    question: "What exception is raised when an iterator is exhausted?",
                    answers: ["EndOfIterator", "StopIteration", "IteratorEmpty", "NoMoreItems", "ExhaustedError", "EndError", "FinishError"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "StopIteration is raised when there are no more items to iterate."
                },
                {
                    question: "What is the advantage of generators over lists?",
                    answers: ["Faster access", "Memory efficiency", "More features", "Better syntax", "Type safety", "Error handling", "Debugging"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Generators are memory efficient as they generate values on-the-fly."
                },
                {
                    question: "What does yield do in a function?",
                    answers: ["Ends the function", "Pauses and returns a value", "Raises an error", "Creates a list", "Imports a module", "Defines a class", "Catches an exception"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "yield pauses the function and returns a value, resuming on next call."
                },
                {
                    question: "Can you iterate over a generator multiple times?",
                    answers: ["Yes, always", "No, only once", "Yes, with reset()", "Yes, with restart()", "Depends on the generator", "Yes, with rewind()", "Yes, with repeat()"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Generators can only be iterated once; they don't store values."
                },
                {
                    question: "What is the output type of range()?",
                    answers: ["list", "tuple", "range object", "generator", "iterator", "set", "dict"],
                    correct: 2,
                    difficulty: "medium",
                    explanation: "range() returns a range object, which is an immutable sequence type."
                }
            ],

            // Category 18: Decorators
            "Decorators": [
                {
                    question: "What symbol is used to apply a decorator?",
                    answers: ["#", "@", "$", "&", "*", "!", "^"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The @ symbol is used to apply decorators to functions."
                },
                {
                    question: "What is a decorator in Python?",
                    answers: ["A comment", "A function that modifies another function", "A class attribute", "A variable type", "A loop construct", "An exception type", "A module"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "A decorator is a function that takes another function and extends its behavior."
                },
                {
                    question: "What does @staticmethod do?",
                    answers: ["Makes method private", "Creates a static method", "Makes method abstract", "Creates a class method", "Makes method final", "Creates a property", "Makes method virtual"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "@staticmethod creates a method that doesn't receive self or cls."
                },
                {
                    question: "What does @classmethod do?",
                    answers: ["Makes method private", "Creates a static method", "Makes method abstract", "Creates a class method", "Makes method final", "Creates a property", "Makes method virtual"],
                    correct: 3,
                    difficulty: "medium",
                    explanation: "@classmethod creates a method that receives the class as first argument (cls)."
                },
                {
                    question: "What does @property do?",
                    answers: ["Makes attribute private", "Creates a getter method", "Makes attribute constant", "Creates a setter method", "Deletes an attribute", "Copies an attribute", "Validates an attribute"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "@property allows a method to be accessed like an attribute."
                },
                {
                    question: "Can decorators take arguments?",
                    answers: ["No, never", "Yes, with wrapper function", "Only strings", "Only numbers", "Only lists", "Only dicts", "Only tuples"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Decorators can take arguments by using a wrapper function."
                },
                {
                    question: "What is the order of multiple decorators?",
                    answers: ["Top to bottom", "Bottom to top", "Random", "Alphabetical", "By length", "By type", "Left to right"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Multiple decorators are applied bottom to top (closest to function first)."
                },
                {
                    question: "What module provides functools.wraps?",
                    answers: ["decorators", "functools", "tools", "utils", "helpers", "wrappers", "functions"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "functools.wraps preserves the original function's metadata in decorators."
                },
                {
                    question: "Can classes be used as decorators?",
                    answers: ["No, only functions", "Yes, with __call__ method", "Only abstract classes", "Only with inheritance", "Only static classes", "Only with metaclasses", "Only dataclasses"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Classes can be decorators if they implement the __call__ method."
                },
                {
                    question: "What is a common use case for decorators?",
                    answers: ["Variable declaration", "Logging and timing", "Loop creation", "Exception raising", "Module importing", "Class inheritance", "File reading"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "Decorators are commonly used for logging, timing, authentication, etc."
                }
            ],

            // Category 19: Regular Expressions
            "Regular Expressions": [
                {
                    question: "Which module is used for regular expressions?",
                    answers: ["regex", "re", "regexp", "pattern", "match", "search", "find"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 're' module provides regular expression operations in Python."
                },
                {
                    question: "What function finds the first match?",
                    answers: ["re.find()", "re.search()", "re.first()", "re.get()", "re.locate()", "re.detect()", "re.discover()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "re.search() scans through the string looking for the first match."
                },
                {
                    question: "What function matches at the beginning of string?",
                    answers: ["re.start()", "re.match()", "re.begin()", "re.first()", "re.head()", "re.front()", "re.initial()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "re.match() only matches at the beginning of the string."
                },
                {
                    question: "What function finds all matches?",
                    answers: ["re.all()", "re.findall()", "re.every()", "re.matches()", "re.getall()", "re.searchall()", "re.locateall()"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "re.findall() returns a list of all matches in the string."
                },
                {
                    question: "What does \\d match in regex?",
                    answers: ["Any letter", "Any digit", "Any whitespace", "Any character", "Start of string", "End of string", "Word boundary"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "\\d matches any digit (0-9)."
                },
                {
                    question: "What does \\w match in regex?",
                    answers: ["Whitespace", "Word character (letter, digit, underscore)", "Any character", "Start of word", "End of word", "Whole word", "Width"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "\\w matches word characters: letters, digits, and underscore."
                },
                {
                    question: "What does * mean in regex?",
                    answers: ["Exactly one", "Zero or more", "One or more", "Zero or one", "Any character", "Start of string", "End of string"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "* matches zero or more occurrences of the preceding element."
                },
                {
                    question: "What does + mean in regex?",
                    answers: ["Exactly one", "Zero or more", "One or more", "Zero or one", "Any character", "Start of string", "End of string"],
                    correct: 2,
                    difficulty: "easy",
                    explanation: "+ matches one or more occurrences of the preceding element."
                },
                {
                    question: "What does ? mean in regex?",
                    answers: ["Exactly one", "Zero or more", "One or more", "Zero or one", "Any character", "Start of string", "End of string"],
                    correct: 3,
                    difficulty: "easy",
                    explanation: "? matches zero or one occurrence of the preceding element."
                },
                {
                    question: "What does ^ mean at the start of a pattern?",
                    answers: ["End of string", "Start of string", "Any character", "Not", "Word boundary", "Digit", "Whitespace"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "^ at the start of a pattern matches the beginning of the string."
                }
            ],

            // Category 20: Advanced Concepts
            "Advanced Concepts": [
                {
                    question: "What is a context manager in Python?",
                    answers: ["A memory manager", "An object for with statement", "A thread manager", "A file manager", "A class manager", "A module manager", "A package manager"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Context managers implement __enter__ and __exit__ for use with 'with' statement."
                },
                {
                    question: "What methods define a context manager?",
                    answers: ["__start__ and __stop__", "__enter__ and __exit__", "__begin__ and __end__", "__open__ and __close__", "__init__ and __del__", "__get__ and __set__", "__call__ and __return__"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Context managers implement __enter__ and __exit__ methods."
                },
                {
                    question: "What is a metaclass?",
                    answers: ["A subclass", "A class of a class", "A superclass", "An abstract class", "A static class", "A final class", "A nested class"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "A metaclass is a class whose instances are classes themselves."
                },
                {
                    question: "What is the default metaclass in Python?",
                    answers: ["object", "type", "class", "meta", "base", "root", "super"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The 'type' is the default metaclass for all classes in Python."
                },
                {
                    question: "What is a descriptor in Python?",
                    answers: ["A documentation string", "An object with __get__, __set__, or __delete__", "A type annotation", "A decorator", "A generator", "An iterator", "A context manager"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Descriptors are objects that define __get__, __set__, or __delete__ methods."
                },
                {
                    question: "What is the GIL in Python?",
                    answers: ["Global Import Lock", "Global Interpreter Lock", "General Interface Layer", "Generic Input Library", "Global Instance Loader", "General Iteration Lock", "Global Index List"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "The Global Interpreter Lock (GIL) prevents multiple threads from executing Python bytecode simultaneously."
                },
                {
                    question: "What module is used for multithreading?",
                    answers: ["thread", "threading", "threads", "multithread", "parallel", "concurrent", "async"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'threading' module provides a high-level interface for threading."
                },
                {
                    question: "What module is used for multiprocessing?",
                    answers: ["process", "multiprocessing", "processes", "parallel", "concurrent", "subprocess", "multi"],
                    correct: 1,
                    difficulty: "easy",
                    explanation: "The 'multiprocessing' module allows spawning processes."
                },
                {
                    question: "What is async/await used for?",
                    answers: ["Multithreading", "Asynchronous programming", "Multiprocessing", "Exception handling", "File handling", "Network programming", "Database access"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "async/await is used for writing asynchronous, non-blocking code."
                },
                {
                    question: "What is a coroutine?",
                    answers: ["A regular function", "A function that can pause and resume", "A class method", "A static method", "A generator only", "A decorator", "A context manager"],
                    correct: 1,
                    difficulty: "medium",
                    explanation: "Coroutines are functions that can pause execution and resume later."
                }
            ]
        };

        // ==================== APPLICATION STATE ====================
        let state = {
            currentScreen: 'welcome',
            selectedCategories: [],
            currentQuiz: [],
            currentQuestionIndex: 0,
            answers: {},
            score: 0,
            totalAnswered: 0,
            correctAnswers: 0,
            streak: 0,
            maxStreak: 0,
            timer: null,
            timeLeft: 30,
            settings: {
                timerDuration: 30,
                questionsPerQuiz: 10,
                showExplanations: true,
                soundEffects: true,
                darkMode: true
            },
            categoryProgress: {}
        };

        // ==================== DOM ELEMENTS ====================
        const elements = {
            bgAnimation: document.getElementById('bgAnimation'),
            settingsBtn: document.getElementById('settingsBtn'),
            settingsPanel: document.getElementById('settingsPanel'),
            closeSettings: document.getElementById('closeSettings'),
            overlay: document.getElementById('overlay'),
            welcomeScreen: document.getElementById('welcomeScreen'),
            quizScreen: document.getElementById('quizScreen'),
            resultsScreen: document.getElementById('resultsScreen'),
            categoryGrid: document.getElementById('categoryGrid'),
            startQuizBtn: document.getElementById('startQuizBtn'),
            randomQuizBtn: document.getElementById('randomQuizBtn'),
            currentCategory: document.getElementById('currentCategory'),
            questionCounter: document.getElementById('questionCounter'),
            timer: document.getElementById('timer'),
            timerValue: document.getElementById('timerValue'),
            progressBar: document.getElementById('progressBar'),
            difficultyBadge: document.getElementById('difficultyBadge'),
            questionText: document.getElementById('questionText'),
            codeBlock: document.getElementById('codeBlock'),
            answersContainer: document.getElementById('answersContainer'),
            explanation: document.getElementById('explanation'),
            explanationText: document.getElementById('explanationText'),
            prevBtn: document.getElementById('prevBtn'),
            nextBtn: document.getElementById('nextBtn'),
            resultsIcon: document.getElementById('resultsIcon'),
            resultsTitle: document.getElementById('resultsTitle'),
            resultsSubtitle: document.getElementById('resultsSubtitle'),
            scoreCircle: document.getElementById('scoreCircle'),
            scorePercentage: document.getElementById('scorePercentage'),
            correctCount: document.getElementById('correctCount'),
            incorrectCount: document.getElementById('incorrectCount'),
            skippedCount: document.getElementById('skippedCount'),
            retryBtn: document.getElementById('retryBtn'),
            homeBtn: document.getElementById('homeBtn'),
            totalScore: document.getElementById('totalScore'),
            questionsAnswered: document.getElementById('questionsAnswered'),
            accuracy: document.getElementById('accuracy'),
            streak: document.getElementById('streak'),
            toast: document.getElementById('toast'),
            toastMessage: document.getElementById('toastMessage'),
            confetti: document.getElementById('confetti'),
            timerDuration: document.getElementById('timerDuration'),
            questionsPerQuiz: document.getElementById('questionsPerQuiz'),
            showExplanations: document.getElementById('showExplanations'),
            soundEffects: document.getElementById('soundEffects'),
            darkMode: document.getElementById('darkMode'),
            resetProgress: document.getElementById('resetProgress')
        };

        // ==================== INITIALIZATION ====================
        function init() {
            loadState();
            createBackgroundAnimation();
            renderCategories();
            updateStats();
            setupEventListeners();
            applySettings();
        }

        function loadState() {
            const savedState = localStorage.getItem('pythonQuizState');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                state = { ...state, ...parsed };
                
                // Restore screen
                if (state.currentScreen === 'quiz' && state.currentQuiz.length > 0) {
                    showScreen('quiz');
                    renderQuestion();
                } else if (state.currentScreen === 'results') {
                    showScreen('results');
                    showResults();
                }
            }
        }

        function saveState() {
            const stateToSave = {
                selectedCategories: state.selectedCategories,
                currentQuiz: state.currentQuiz,
                currentQuestionIndex: state.currentQuestionIndex,
                answers: state.answers,
                score: state.score,
                totalAnswered: state.totalAnswered,
                correctAnswers: state.correctAnswers,
                streak: state.streak,
                maxStreak: state.maxStreak,
                settings: state.settings,
                categoryProgress: state.categoryProgress,
                currentScreen: state.currentScreen
            };
            localStorage.setItem('pythonQuizState', JSON.stringify(stateToSave));
        }

        // ==================== BACKGROUND ANIMATION ====================
        function createBackgroundAnimation() {
            const snakes = ['', '', '', '', '', '', '', '', '', ''];
            for (let i = 0; i < 15; i++) {
                const snake = document.createElement('div');
                snake.className = 'snake';
                snake.textContent = snakes[Math.floor(Math.random() * snakes.length)];
                snake.style.left = Math.random() * 100 + '%';
                snake.style.animationDelay = Math.random() * 15 + 's';
                snake.style.animationDuration = (15 + Math.random() * 10) + 's';
                elements.bgAnimation.appendChild(snake);
            }
        }

        // ==================== CATEGORY RENDERING ====================
        function renderCategories() {
            const categoryIcons = {
                "Basic Syntax": "fa-code",
                "Data Types": "fa-database",
                "Strings": "fa-font",
                "Lists": "fa-list",
                "Dictionaries": "fa-book",
                "Tuples": "fa-layer-group",
                "Control Flow": "fa-random",
                "Functions": "fa-cube",
                "Modules & Imports": "fa-puzzle-piece",
                "File Handling": "fa-file-code",
                "Exception Handling": "fa-exclamation-triangle",
                "OOP Basics": "fa-sitemap",
                "List Comprehensions": "fa-compress-arrows-alt",
                "Built-in Functions": "fa-tools",
                "String Methods": "fa-text-width",
                "Operators": "fa-calculator",
                "Iterators & Generators": "fa-sync",
                "Decorators": "fa-at",
                "Regular Expressions": "fa-search",
                "Advanced Concepts": "fa-rocket"
            };

            elements.categoryGrid.innerHTML = '';
            
            Object.keys(questionDatabase).forEach(category => {
                const questions = questionDatabase[category];
                const progress = state.categoryProgress[category] || { correct: 0, total: 0 };
                const percentage = progress.total > 0 ? Math.round((progress.correct / progress.total) * 100) : 0;
                
                const card = document.createElement('div');
                card.className = 'category-card';
                card.dataset.category = category;
                
                if (state.selectedCategories.includes(category)) {
                    card.classList.add('selected');
                }
                
                card.innerHTML = `
                    <i class="fas ${categoryIcons[category] || 'fa-question'}"></i>
                    <h4>${category}</h4>
                    <div class="count">${questions.length} questions</div>
                    ${progress.total > 0 ? `<div class="count" style="color: var(--success)">${percentage}% mastered</div>` : ''}
                `;
                
                card.addEventListener('click', () => toggleCategory(category, card));
                elements.categoryGrid.appendChild(card);
            });
        }

        function toggleCategory(category, card) {
            const index = state.selectedCategories.indexOf(category);
            if (index > -1) {
                state.selectedCategories.splice(index, 1);
                card.classList.remove('selected');
            } else {
                state.selectedCategories.push(category);
                card.classList.add('selected');
            }
            saveState();
        }

        // ==================== QUIZ LOGIC ====================
        function startQuiz(random = false) {
            let categories = random ? Object.keys(questionDatabase) : state.selectedCategories;
            
            if (categories.length === 0) {
                showToast('Please select at least one category', 'error');
                return;
            }

            // Gather questions
            let allQuestions = [];
            categories.forEach(category => {
                const questions = questionDatabase[category].map(q => ({
                    ...q,
                    category: category
                }));
                allQuestions = allQuestions.concat(questions);
            });

            // Shuffle questions
            allQuestions = shuffleArray(allQuestions);

            // Limit questions
            const limit = state.settings.questionsPerQuiz === 0 ? allQuestions.length : state.settings.questionsPerQuiz;
            state.currentQuiz = allQuestions.slice(0, Math.min(limit, allQuestions.length));
            
            // Prepare answers for each question (random 5 from 7)
            state.currentQuiz = state.currentQuiz.map(q => {
                const shuffledAnswers = prepareAnswers(q.answers, q.correct);
                return {
                    ...q,
                    displayAnswers: shuffledAnswers.answers,
                    correctIndex: shuffledAnswers.correctIndex
                };
            });

            state.currentQuestionIndex = 0;
            state.answers = {};
            state.currentScreen = 'quiz';
            
            showScreen('quiz');
            renderQuestion();
            saveState();
        }

        function prepareAnswers(answers, correctIndex) {
            // Get correct answer
            const correctAnswer = answers[correctIndex];
            
            // Get wrong answers
            const wrongAnswers = answers.filter((_, i) => i !== correctIndex);
            
            // Shuffle wrong answers and take 4
            const shuffledWrong = shuffleArray([...wrongAnswers]).slice(0, 4);
            
            // Combine with correct answer
            const selectedAnswers = [...shuffledWrong, correctAnswer];
            
            // Shuffle final array
            const finalAnswers = shuffleArray(selectedAnswers);
            
            // Find new correct index
            const newCorrectIndex = finalAnswers.indexOf(correctAnswer);
            
            return {
                answers: finalAnswers,
                correctIndex: newCorrectIndex
            };
        }

        function renderQuestion() {
            const question = state.currentQuiz[state.currentQuestionIndex];
            
            // Update header
            elements.currentCategory.textContent = question.category;
            elements.questionCounter.textContent = `${state.currentQuestionIndex + 1}/${state.currentQuiz.length}`;
            
            // Update progress bar
            const progress = ((state.currentQuestionIndex) / state.currentQuiz.length) * 100;
            elements.progressBar.style.width = `${progress}%`;
            
            // Update difficulty badge
            elements.difficultyBadge.textContent = question.difficulty;
            elements.difficultyBadge.className = `difficulty-badge difficulty-${question.difficulty}`;
            
            // Update question text
            elements.questionText.textContent = question.question;
            
            // Handle code block
            if (question.code) {
                elements.codeBlock.textContent = question.code;
                elements.codeBlock.classList.remove('hidden');
            } else {
                elements.codeBlock.classList.add('hidden');
            }
            
            // Render answers
            renderAnswers(question);
            
            // Update navigation
            elements.prevBtn.disabled = state.currentQuestionIndex === 0;
            updateNextButton();
            
            // Handle explanation
            const answered = state.answers[state.currentQuestionIndex] !== undefined;
            if (answered && state.settings.showExplanations) {
                elements.explanation.classList.remove('hidden');
                elements.explanationText.textContent = question.explanation;
            } else {
                elements.explanation.classList.add('hidden');
            }
            
            // Start timer
            startTimer();
        }

        function renderAnswers(question) {
            const letters = ['A', 'B', 'C', 'D', 'E'];
            const answered = state.answers[state.currentQuestionIndex];
            
            elements.answersContainer.innerHTML = '';
            
            question.displayAnswers.forEach((answer, index) => {
                const option = document.createElement('div');
                option.className = 'answer-option';
                option.dataset.index = index;
                
                if (answered !== undefined) {
                    option.classList.add('disabled');
                    if (index === question.correctIndex) {
                        option.classList.add('correct');
                    } else if (index === answered.selected) {
                        option.classList.add('incorrect');
                    }
                }
                
                const isCorrect = index === question.correctIndex;
                const iconClass = isCorrect ? 'fa-check' : 'fa-times';
                const iconColor = isCorrect ? 'var(--success)' : 'var(--danger)';
                
                option.innerHTML = `
                    <span class="answer-letter">${letters[index]}</span>
                    <span class="answer-text">${answer}</span>
                    <i class="fas ${iconClass} answer-icon" style="color: ${iconColor}"></i>
                `;
                
                if (answered === undefined) {
                    option.addEventListener('click', () => selectAnswer(index));
                }
                
                elements.answersContainer.appendChild(option);
            });
        }

        function selectAnswer(index) {
            const question = state.currentQuiz[state.currentQuestionIndex];
            const isCorrect = index === question.correctIndex;
            
            // Stop timer
            stopTimer();
            
            // Record answer
            state.answers[state.currentQuestionIndex] = {
                selected: index,
                correct: isCorrect
            };
            
            // Update stats
            state.totalAnswered++;
            if (isCorrect) {
                state.correctAnswers++;
                state.score += question.difficulty === 'easy' ? 10 : 20;
                state.streak++;
                if (state.streak > state.maxStreak) {
                    state.maxStreak = state.streak;
                }
                playSound('correct');
            } else {
                state.streak = 0;
                playSound('incorrect');
            }
            
            // Update category progress
            if (!state.categoryProgress[question.category]) {
                state.categoryProgress[question.category] = { correct: 0, total: 0 };
            }
            state.categoryProgress[question.category].total++;
            if (isCorrect) {
                state.categoryProgress[question.category].correct++;
            }
            
            // Update UI
            updateStats();
            renderAnswers(question);
            
            // Show explanation
            if (state.settings.showExplanations) {
                elements.explanation.classList.remove('hidden');
                elements.explanationText.textContent = question.explanation;
            }
            
            updateNextButton();
            saveState();
        }

        function updateNextButton() {
            const isLastQuestion = state.currentQuestionIndex === state.currentQuiz.length - 1;
            const answered = state.answers[state.currentQuestionIndex] !== undefined;
            
            if (isLastQuestion) {
                elements.nextBtn.innerHTML = 'Finish <i class="fas fa-flag-checkered"></i>';
            } else {
                elements.nextBtn.innerHTML = 'Next <i class="fas fa-arrow-right"></i>';
            }
        }

        function nextQuestion() {
            if (state.currentQuestionIndex < state.currentQuiz.length - 1) {
                state.currentQuestionIndex++;
                renderQuestion();
                saveState();
            } else {
                finishQuiz();
            }
        }

        function prevQuestion() {
            if (state.currentQuestionIndex > 0) {
                state.currentQuestionIndex--;
                renderQuestion();
                saveState();
            }
        }

        function finishQuiz() {
            stopTimer();
            state.currentScreen = 'results';
            showScreen('results');
            showResults();
            saveState();
        }

        // ==================== TIMER ====================
        function startTimer() {
            stopTimer();
            
            if (state.settings.timerDuration === 0) {
                elements.timer.classList.add('hidden');
                return;
            }
            
            elements.timer.classList.remove('hidden');
            state.timeLeft = state.settings.timerDuration;
            elements.timerValue.textContent = state.timeLeft;
            elements.timer.classList.remove('warning');
            
            // Don't start timer if already answered
            if (state.answers[state.currentQuestionIndex] !== undefined) {
                return;
            }
            
            state.timer = setInterval(() => {
                state.timeLeft--;
                elements.timerValue.textContent = state.timeLeft;
                
                if (state.timeLeft <= 5) {
                    elements.timer.classList.add('warning');
                }
                
                if (state.timeLeft <= 0) {
                    stopTimer();
                    timeUp();
                }
            }, 1000);
        }

        function stopTimer() {
            if (state.timer) {
                clearInterval(state.timer);
                state.timer = null;
            }
        }

        function timeUp() {
            const question = state.currentQuiz[state.currentQuestionIndex];
            
            // Record as skipped/wrong
            state.answers[state.currentQuestionIndex] = {
                selected: -1,
                correct: false,
                timedOut: true
            };
            
            state.totalAnswered++;
            state.streak = 0;
            
            // Update category progress
            if (!state.categoryProgress[question.category]) {
                state.categoryProgress[question.category] = { correct: 0, total: 0 };
            }
            state.categoryProgress[question.category].total++;
            
            playSound('timeout');
            showToast("Time's up!", 'error');
            
            updateStats();
            renderAnswers(question);
            
            if (state.settings.showExplanations) {
                elements.explanation.classList.remove('hidden');
                elements.explanationText.textContent = question.explanation;
            }
            
            updateNextButton();
            saveState();
        }

        // ==================== RESULTS ====================
        function showResults() {
            const totalQuestions = state.currentQuiz.length;
            const answered = Object.keys(state.answers).length;
            const correct = Object.values(state.answers).filter(a => a.correct).length;
            const incorrect = Object.values(state.answers).filter(a => !a.correct && !a.timedOut).length;
            const skipped = totalQuestions - answered;
            const timedOut = Object.values(state.answers).filter(a => a.timedOut).length;
            
            const percentage = Math.round((correct / totalQuestions) * 100);
            
            // Update score circle
            elements.scoreCircle.style.setProperty('--percentage', `${percentage}%`);
            elements.scorePercentage.textContent = `${percentage}%`;
            
            // Update counts
            elements.correctCount.textContent = correct;
            elements.incorrectCount.textContent = incorrect + timedOut;
            elements.skippedCount.textContent = skipped;
            
            // Update title and icon based on score
            if (percentage >= 90) {
                elements.resultsIcon.innerHTML = '<i class="fas fa-trophy"></i>';
                elements.resultsIcon.className = 'results-icon excellent';
                elements.resultsTitle.textContent = 'Excellent!';
                elements.resultsSubtitle.textContent = 'You\'re a Python master!';
                showConfetti();
            } else if (percentage >= 70) {
                elements.resultsIcon.innerHTML = '<i class="fas fa-medal"></i>';
                elements.resultsIcon.className = 'results-icon good';
                elements.resultsTitle.textContent = 'Great Job!';
                elements.resultsSubtitle.textContent = 'You know your Python well!';
            } else if (percentage >= 50) {
                elements.resultsIcon.innerHTML = '<i class="fas fa-thumbs-up"></i>';
                elements.resultsIcon.className = 'results-icon average';
                elements.resultsTitle.textContent = 'Good Effort!';
                elements.resultsSubtitle.textContent = 'Keep practicing to improve!';
            } else {
                elements.resultsIcon.innerHTML = '<i class="fas fa-book-reader"></i>';
                elements.resultsIcon.className = 'results-icon poor';
                elements.resultsTitle.textContent = 'Keep Learning!';
                elements.resultsSubtitle.textContent = 'Practice makes perfect!';
            }
        }

        // ==================== CONFETTI ====================
        function showConfetti() {
            const canvas = elements.confetti;
            canvas.classList.remove('hidden');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const confettiPieces = [];
            const colors = ['#FFD43B', '#306998', '#28a745', '#dc3545', '#667eea', '#764ba2'];
            
            for (let i = 0; i < 150; i++) {
                confettiPieces.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    speed: Math.random() * 3 + 2,
                    angle: Math.random() * 360,
                    spin: Math.random() * 10 - 5
                });
            }
            
            let animationFrame;
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                let allDone = true;
                confettiPieces.forEach(piece => {
                    if (piece.y < canvas.height) {
                        allDone = false;
                        piece.y += piece.speed;
                        piece.angle += piece.spin;
                        
                        ctx.save();
                        ctx.translate(piece.x, piece.y);
                        ctx.rotate(piece.angle * Math.PI / 180);
                        ctx.fillStyle = piece.color;
                        ctx.fillRect(-piece.w / 2, -piece.h / 2, piece.w, piece.h);
                        ctx.restore();
                    }
                });
                
                if (!allDone) {
                    animationFrame = requestAnimationFrame(animate);
                } else {
                    canvas.classList.add('hidden');
                    cancelAnimationFrame(animationFrame);
                }
            }
            
            animate();
            
            setTimeout(() => {
                canvas.classList.add('hidden');
                cancelAnimationFrame(animationFrame);
            }, 5000);
        }

        // ==================== SCREEN MANAGEMENT ====================
        function showScreen(screen) {
            elements.welcomeScreen.classList.add('hidden');
            elements.quizScreen.classList.add('hidden');
            elements.resultsScreen.classList.add('hidden');
            
            switch (screen) {
                case 'welcome':
                    elements.welcomeScreen.classList.remove('hidden');
                    break;
                case 'quiz':
                    elements.quizScreen.classList.remove('hidden');
                    break;
                case 'results':
                    elements.resultsScreen.classList.remove('hidden');
                    break;
            }
            
            state.currentScreen = screen;
        }

        // ==================== STATS ====================
        function updateStats() {
            elements.totalScore.textContent = state.score;
            elements.questionsAnswered.textContent = state.totalAnswered;
            elements.streak.textContent = state.streak;
            
            const accuracy = state.totalAnswered > 0 
                ? Math.round((state.correctAnswers / state.totalAnswered) * 100) 
                : 0;
            elements.accuracy.textContent = `${accuracy}%`;
        }

        // ==================== SETTINGS ====================
        function setupEventListeners() {
            // Settings panel
            elements.settingsBtn.addEventListener('click', openSettings);
            elements.closeSettings.addEventListener('click', closeSettings);
            elements.overlay.addEventListener('click', closeSettings);
            
            // Quiz controls
            elements.startQuizBtn.addEventListener('click', () => startQuiz(false));
            elements.randomQuizBtn.addEventListener('click', () => startQuiz(true));
            elements.nextBtn.addEventListener('click', nextQuestion);
            elements.prevBtn.addEventListener('click', prevQuestion);
            elements.retryBtn.addEventListener('click', () => {
                state.currentQuiz = [];
                state.answers = {};
                startQuiz(state.selectedCategories.length === 0);
            });
            elements.homeBtn.addEventListener('click', goHome);
            
            // Settings controls
            elements.timerDuration.addEventListener('change', (e) => {
                state.settings.timerDuration = parseInt(e.target.value);
                saveState();
            });
            
            elements.questionsPerQuiz.addEventListener('change', (e) => {
                state.settings.questionsPerQuiz = parseInt(e.target.value);
                saveState();
            });
            
            elements.showExplanations.addEventListener('change', (e) => {
                state.settings.showExplanations = e.target.checked;
                saveState();
            });
            
            elements.soundEffects.addEventListener('change', (e) => {
                state.settings.soundEffects = e.target.checked;
                saveState();
            });
            
            elements.darkMode.addEventListener('change', (e) => {
                state.settings.darkMode = e.target.checked;
                saveState();
            });
            
            elements.resetProgress.addEventListener('click', resetProgress);
            
            // Keyboard navigation
            document.addEventListener('keydown', handleKeyboard);
            
            // Window resize
            window.addEventListener('resize', handleResize);
        }

        function openSettings() {
            elements.settingsPanel.classList.add('open');
            elements.overlay.classList.add('show');
        }

        function closeSettings() {
            elements.settingsPanel.classList.remove('open');
            elements.overlay.classList.remove('show');
        }

        function applySettings() {
            elements.timerDuration.value = state.settings.timerDuration;
            elements.questionsPerQuiz.value = state.settings.questionsPerQuiz;
            elements.showExplanations.checked = state.settings.showExplanations;
            elements.soundEffects.checked = state.settings.soundEffects;
            elements.darkMode.checked = state.settings.darkMode;
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                state.score = 0;
                state.totalAnswered = 0;
                state.correctAnswers = 0;
                state.streak = 0;
                state.maxStreak = 0;
                state.categoryProgress = {};
                state.selectedCategories = [];
                state.currentQuiz = [];
                state.answers = {};
                
                updateStats();
                renderCategories();
                goHome();
                saveState();
                showToast('Progress reset successfully', 'success');
            }
        }

        function goHome() {
            stopTimer();
            state.currentScreen = 'welcome';
            showScreen('welcome');
            renderCategories();
            saveState();
        }

        // ==================== UTILITIES ====================
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function showToast(message, type = 'success') {
            elements.toastMessage.textContent = message;
            elements.toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                elements.toast.classList.remove('show');
            }, 3000);
        }

        function playSound(type) {
            if (!state.settings.soundEffects) return;
            
            // Create audio context for sound effects
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                switch (type) {
                    case 'correct':
                        oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                        oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                        oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                        break;
                    case 'incorrect':
                        oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(150, audioContext.currentTime + 0.1);
                        break;
                    case 'timeout':
                        oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(200, audioContext.currentTime + 0.2);
                        break;
                }
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } catch (e) {
                // Audio not supported
            }
        }

        function handleKeyboard(e) {
            if (state.currentScreen !== 'quiz') return;
            
            const answered = state.answers[state.currentQuestionIndex] !== undefined;
            
            // Number keys 1-5 for answers
            if (!answered && e.key >= '1' && e.key <= '5') {
                const index = parseInt(e.key) - 1;
                if (index < state.currentQuiz[state.currentQuestionIndex].displayAnswers.length) {
                    selectAnswer(index);
                }
            }
            
            // Arrow keys for navigation
            if (e.key === 'ArrowRight' || e.key === 'Enter') {
                if (answered || e.key === 'Enter') {
                    nextQuestion();
                }
            }
            
            if (e.key === 'ArrowLeft') {
                prevQuestion();
            }
            
            // Letter keys A-E for answers
            if (!answered) {
                const letterIndex = 'abcde'.indexOf(e.key.toLowerCase());
                if (letterIndex !== -1 && letterIndex < state.currentQuiz[state.currentQuestionIndex].displayAnswers.length) {
                    selectAnswer(letterIndex);
                }
            }
        }

        function handleResize() {
            // Handle orientation changes
            const isLandscape = window.innerWidth > window.innerHeight;
            document.body.classList.toggle('landscape', isLandscape);
        }

        // ==================== START APPLICATION ====================
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
